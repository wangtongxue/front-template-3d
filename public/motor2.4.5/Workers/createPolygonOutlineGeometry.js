define(["./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Ellipsoid-1cbb4ac9","./Transforms-c20c38d0","./RuntimeError-5b606d78","./Cartesian2-73569d25","./WebGLConstants-30fc6f5c","./ComponentDatatype-a863af81","./GeometryAttribute-6b3c7112","./GeometryAttributes-cb18da36","./AttributeCompression-5e3c38a2","./GeometryPipeline-585f444f","./EncodedCartesian3-fbe51c6d","./IndexDatatype-f12d39b5","./IntersectionTests-faaebeeb","./Plane-6ff6c057","./GeometryOffsetAttribute-5cfc2755","./GeometryInstance-ebd8a828","./arrayRemoveDuplicates-9458abce","./EllipsoidTangentPlane-13a4f7fd","./ArcType-2ee8dfbb","./EllipsoidRhumbLine-01425f3c","./PolygonPipeline-5110db34","./PolygonGeometryLibrary-bbb55e41"],(function(e,t,i,r,o,n,a,l,s,y,p,u,d,c,f,h,g,m,b,P,E,v,A,G,_){"use strict";var T=[],H=[];function L(e,t,i,r,o){var n,a,l=E.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,T);G.PolygonPipeline.computeWindingOrder2D(l)===G.WindingOrder.CLOCKWISE&&(l.reverse(),t=t.slice().reverse());var u=t.length,d=0;if(r)for(n=new Float64Array(2*u*3),a=0;a<u;a++){var c=t[a],h=t[(a+1)%u];n[d++]=c.x,n[d++]=c.y,n[d++]=c.z,n[d++]=h.x,n[d++]=h.y,n[d++]=h.z}else{var g=0;if(o===v.ArcType.GEODESIC)for(a=0;a<u;a++)g+=_.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%u],i);else if(o===v.ArcType.RHUMB)for(a=0;a<u;a++)g+=_.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%u],i);for(n=new Float64Array(3*g),a=0;a<u;a++){var m;o===v.ArcType.GEODESIC?m=_.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%u],i,H):o===v.ArcType.RHUMB&&(m=_.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%u],i,H));for(var P=m.length,A=0;A<P;++A)n[d++]=m[A]}}var L=2*(u=n.length/3),C=f.IndexDatatype.createTypedArray(u,L);for(d=0,a=0;a<u-1;a++)C[d++]=a,C[d++]=a+1;return C[d++]=u-1,C[d++]=0,new b.GeometryInstance({geometry:new y.Geometry({attributes:new p.GeometryAttributes({position:new y.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:C,primitiveType:y.PrimitiveType.LINES})})}function C(e,t,i,r,o){var n,a,l=E.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,T);G.PolygonPipeline.computeWindingOrder2D(l)===G.WindingOrder.CLOCKWISE&&(l.reverse(),t=t.slice().reverse());var u=t.length,d=new Array(u),c=0;if(r)for(n=new Float64Array(2*u*3*2),a=0;a<u;++a){d[a]=c/3;var h=t[a],g=t[(a+1)%u];n[c++]=h.x,n[c++]=h.y,n[c++]=h.z,n[c++]=g.x,n[c++]=g.y,n[c++]=g.z}else{var m=0;if(o===v.ArcType.GEODESIC)for(a=0;a<u;a++)m+=_.PolygonGeometryLibrary.subdivideLineCount(t[a],t[(a+1)%u],i);else if(o===v.ArcType.RHUMB)for(a=0;a<u;a++)m+=_.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[a],t[(a+1)%u],i);for(n=new Float64Array(3*m*2),a=0;a<u;++a){var P;d[a]=c/3,o===v.ArcType.GEODESIC?P=_.PolygonGeometryLibrary.subdivideLine(t[a],t[(a+1)%u],i,H):o===v.ArcType.RHUMB&&(P=_.PolygonGeometryLibrary.subdivideRhumbLine(e,t[a],t[(a+1)%u],i,H));for(var A=P.length,L=0;L<A;++L)n[c++]=P[L]}}u=n.length/6;var C=d.length,O=2*(2*u+C),D=f.IndexDatatype.createTypedArray(u+C,O);for(c=0,a=0;a<u;++a)D[c++]=a,D[c++]=(a+1)%u,D[c++]=a+u,D[c++]=(a+1)%u+u;for(a=0;a<C;a++){var I=d[a];D[c++]=I,D[c++]=I+u}return new b.GeometryInstance({geometry:new y.Geometry({attributes:new p.GeometryAttributes({position:new y.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:D,primitiveType:y.PrimitiveType.LINES})})}function O(o){if(t.Check.typeOf.object("options",o),t.Check.typeOf.object("options.polygonHierarchy",o.polygonHierarchy),o.perPositionHeight&&e.defined(o.height))throw new t.DeveloperError("Cannot use both options.perPositionHeight and options.height");if(e.defined(o.arcType)&&o.arcType!==v.ArcType.GEODESIC&&o.arcType!==v.ArcType.RHUMB)throw new t.DeveloperError("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var n=o.polygonHierarchy,a=e.defaultValue(o.ellipsoid,r.Ellipsoid.WGS84),l=e.defaultValue(o.granularity,i.CesiumMath.RADIANS_PER_DEGREE),s=e.defaultValue(o.perPositionHeight,!1),y=s&&e.defined(o.extrudedHeight),p=e.defaultValue(o.arcType,v.ArcType.GEODESIC),u=e.defaultValue(o.height,0),d=e.defaultValue(o.extrudedHeight,u);if(!y){var c=Math.max(u,d);d=Math.min(u,d),u=c}this._ellipsoid=r.Ellipsoid.clone(a),this._granularity=l,this._height=u,this._extrudedHeight=d,this._arcType=p,this._polygonHierarchy=n,this._perPositionHeight=s,this._perPositionHeightExtrude=y,this._offsetAttribute=o.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=_.PolygonGeometryLibrary.computeHierarchyPackedLength(n)+r.Ellipsoid.packedLength+8}O.pack=function(i,o,n){return t.Check.typeOf.object("value",i),t.Check.defined("array",o),n=e.defaultValue(n,0),n=_.PolygonGeometryLibrary.packPolygonHierarchy(i._polygonHierarchy,o,n),r.Ellipsoid.pack(i._ellipsoid,o,n),n+=r.Ellipsoid.packedLength,o[n++]=i._height,o[n++]=i._extrudedHeight,o[n++]=i._granularity,o[n++]=i._perPositionHeightExtrude?1:0,o[n++]=i._perPositionHeight?1:0,o[n++]=i._arcType,o[n++]=e.defaultValue(i._offsetAttribute,-1),o[n]=i.packedLength,o};var D=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),I={polygonHierarchy:{}};return O.unpack=function(i,o,n){t.Check.defined("array",i),o=e.defaultValue(o,0);var a=_.PolygonGeometryLibrary.unpackPolygonHierarchy(i,o);o=a.startingIndex,delete a.startingIndex;var l=r.Ellipsoid.unpack(i,o,D);o+=r.Ellipsoid.packedLength;var s=i[o++],y=i[o++],p=i[o++],u=1===i[o++],d=1===i[o++],c=i[o++],f=i[o++],h=i[o];return e.defined(n)||(n=new O(I)),n._polygonHierarchy=a,n._ellipsoid=r.Ellipsoid.clone(l,n._ellipsoid),n._height=s,n._extrudedHeight=y,n._granularity=p,n._perPositionHeight=d,n._perPositionHeightExtrude=u,n._arcType=c,n._offsetAttribute=-1===f?void 0:f,n.packedLength=h,n},O.fromPositions=function(i){return i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT),t.Check.defined("options.positions",i.positions),new O({polygonHierarchy:{positions:i.positions},height:i.height,extrudedHeight:i.extrudedHeight,ellipsoid:i.ellipsoid,granularity:i.granularity,perPositionHeight:i.perPositionHeight,arcType:i.arcType,offsetAttribute:i.offsetAttribute})},O.createGeometry=function(t){var r=t._ellipsoid,n=t._granularity,a=t._polygonHierarchy,l=t._perPositionHeight,p=t._arcType,u=_.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(a,!l,r);if(0!==u.length){var c,f,h,g=[],b=i.CesiumMath.chordLength(n,r.maximumRadius),P=t._height,E=t._extrudedHeight;if(t._perPositionHeightExtrude||!i.CesiumMath.equalsEpsilon(P,E,0,i.CesiumMath.EPSILON2))for(h=0;h<u.length;h++){if((c=C(r,u[h],b,l,p)).geometry=_.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(c.geometry,P,E,r,l),e.defined(t._offsetAttribute)){var v=c.geometry.attributes.position.values.length/3,A=new Uint8Array(v);t._offsetAttribute===m.GeometryOffsetAttribute.TOP?A=m.arrayFill(A,1,0,v/2):(f=t._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,A=m.arrayFill(A,f)),c.geometry.attributes.applyOffset=new y.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}g.push(c)}else for(h=0;h<u.length;h++){if((c=L(r,u[h],b,l,p)).geometry.attributes.position.values=G.PolygonPipeline.scaleToGeodeticHeight(c.geometry.attributes.position.values,P,r,!l),e.defined(t._offsetAttribute)){var T=c.geometry.attributes.position.values.length,H=new Uint8Array(T/3);f=t._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,m.arrayFill(H,f),c.geometry.attributes.applyOffset=new y.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:H})}g.push(c)}var O=d.GeometryPipeline.combineInstances(g)[0],D=o.BoundingSphere.fromVertices(O.attributes.position.values);return new y.Geometry({attributes:O.attributes,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:D,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=O.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),O.createGeometry(t)}}));
//# sourceMappingURL=createPolygonOutlineGeometry.js.map

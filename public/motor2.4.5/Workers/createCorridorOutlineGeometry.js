define(["./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Ellipsoid-1cbb4ac9","./Transforms-c20c38d0","./RuntimeError-5b606d78","./Cartesian2-73569d25","./WebGLConstants-30fc6f5c","./ComponentDatatype-a863af81","./GeometryAttribute-6b3c7112","./GeometryAttributes-cb18da36","./IndexDatatype-f12d39b5","./IntersectionTests-faaebeeb","./Plane-6ff6c057","./GeometryOffsetAttribute-5cfc2755","./arrayRemoveDuplicates-9458abce","./EllipsoidTangentPlane-13a4f7fd","./EllipsoidRhumbLine-01425f3c","./PolygonPipeline-5110db34","./PolylineVolumeGeometryLibrary-7075293a","./EllipsoidGeodesic-2bb1f4ee","./PolylinePipeline-2458e977","./CorridorGeometryLibrary-945a617d"],(function(e,t,i,r,o,a,n,s,l,d,u,p,f,h,y,c,b,g,m,v,A,_,C){"use strict";var E=new r.Cartesian3,G=new r.Cartesian3,T=new r.Cartesian3;function P(t,i){var o,a,n,s=[],f=t.positions,h=t.corners,y=t.endPositions,c=new u.GeometryAttributes,b=0,g=0,m=0;for(a=0;a<f.length;a+=2)b+=n=f[a].length-3,m+=n/3*4,g+=f[a+1].length-3;for(b+=3,g+=3,a=0;a<h.length;a++){o=h[a];var A=h[a].leftPositions;e.defined(A)?(b+=n=A.length,m+=n/3*2):(g+=n=h[a].rightPositions.length,m+=n/3*2)}var _,P=e.defined(y);P&&(b+=_=y[0].length-3,g+=_,m+=4*(_/=3));var w,L,k,D,O,N,V=b+g,x=new Float64Array(V),H=0,I=V-1,S=_/2,M=p.IndexDatatype.createTypedArray(V/3,m+4),R=0;if(M[R++]=H/3,M[R++]=(I-2)/3,P){s.push(H/3),N=E,O=G;var B=y[0];for(a=0;a<S;a++)N=r.Cartesian3.fromArray(B,3*(S-1-a),N),O=r.Cartesian3.fromArray(B,3*(S+a),O),C.CorridorGeometryLibrary.addAttribute(x,O,H),C.CorridorGeometryLibrary.addAttribute(x,N,void 0,I),D=(L=H/3)+1,k=(w=(I-2)/3)-1,M[R++]=w,M[R++]=k,M[R++]=L,M[R++]=D,H+=3,I-=3}var U=0,F=f[U++],j=f[U++];for(x.set(F,H),x.set(j,I-j.length+1),n=j.length-3,s.push(H/3,(I-2)/3),a=0;a<n;a+=3)D=(L=H/3)+1,k=(w=(I-2)/3)-1,M[R++]=w,M[R++]=k,M[R++]=L,M[R++]=D,H+=3,I-=3;for(a=0;a<h.length;a++){var Y,q,W=(o=h[a]).leftPositions,J=o.rightPositions,z=T;if(e.defined(W)){for(I-=3,q=k,s.push(D),Y=0;Y<W.length/3;Y++)z=r.Cartesian3.fromArray(W,3*Y,z),M[R++]=q-Y-1,M[R++]=q-Y,C.CorridorGeometryLibrary.addAttribute(x,z,void 0,I),I-=3;s.push(q-Math.floor(W.length/6)),i===v.CornerType.BEVELED&&s.push((I-2)/3+1),H+=3}else{for(H+=3,q=D,s.push(k),Y=0;Y<J.length/3;Y++)z=r.Cartesian3.fromArray(J,3*Y,z),M[R++]=q+Y,M[R++]=q+Y+1,C.CorridorGeometryLibrary.addAttribute(x,z,H),H+=3;s.push(q+Math.floor(J.length/6)),i===v.CornerType.BEVELED&&s.push(H/3-1),I-=3}for(F=f[U++],j=f[U++],F.splice(0,3),j.splice(j.length-3,3),x.set(F,H),x.set(j,I-j.length+1),n=j.length-3,Y=0;Y<j.length;Y+=3)L=(D=H/3)-1,w=(k=(I-2)/3)+1,M[R++]=w,M[R++]=k,M[R++]=L,M[R++]=D,H+=3,I-=3;H-=3,I+=3,s.push(H/3,(I-2)/3)}if(P){H+=3,I-=3,N=E,O=G;var K=y[1];for(a=0;a<S;a++)N=r.Cartesian3.fromArray(K,3*(_-a-1),N),O=r.Cartesian3.fromArray(K,3*a,O),C.CorridorGeometryLibrary.addAttribute(x,N,void 0,I),C.CorridorGeometryLibrary.addAttribute(x,O,H),L=(D=H/3)-1,w=(k=(I-2)/3)+1,M[R++]=w,M[R++]=k,M[R++]=L,M[R++]=D,H+=3,I-=3;s.push(H/3)}else s.push(H/3,(I-2)/3);return M[R++]=H/3,M[R++]=(I-2)/3,c.position=new d.GeometryAttribute({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:x}),{attributes:c,indices:M,wallIndices:s}}function w(o){var a=(o=e.defaultValue(o,e.defaultValue.EMPTY_OBJECT)).positions,n=o.width;t.Check.typeOf.object("options.positions",a),t.Check.typeOf.number("options.width",n);var s=e.defaultValue(o.height,0),l=e.defaultValue(o.extrudedHeight,s);this._positions=a,this._ellipsoid=r.Ellipsoid.clone(e.defaultValue(o.ellipsoid,r.Ellipsoid.WGS84)),this._width=n,this._height=Math.max(s,l),this._extrudedHeight=Math.min(s,l),this._cornerType=e.defaultValue(o.cornerType,v.CornerType.ROUNDED),this._granularity=e.defaultValue(o.granularity,i.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=o.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+a.length*r.Cartesian3.packedLength+r.Ellipsoid.packedLength+6}w.pack=function(i,o,a){t.Check.typeOf.object("value",i),t.Check.typeOf.object("array",o),a=e.defaultValue(a,0);var n=i._positions,s=n.length;o[a++]=s;for(var l=0;l<s;++l,a+=r.Cartesian3.packedLength)r.Cartesian3.pack(n[l],o,a);return r.Ellipsoid.pack(i._ellipsoid,o,a),a+=r.Ellipsoid.packedLength,o[a++]=i._width,o[a++]=i._height,o[a++]=i._extrudedHeight,o[a++]=i._cornerType,o[a++]=i._granularity,o[a]=e.defaultValue(i._offsetAttribute,-1),o};var L=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),k={positions:void 0,ellipsoid:L,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return w.unpack=function(i,o,a){t.Check.typeOf.object("array",i),o=e.defaultValue(o,0);for(var n=i[o++],s=new Array(n),l=0;l<n;++l,o+=r.Cartesian3.packedLength)s[l]=r.Cartesian3.unpack(i,o);var d=r.Ellipsoid.unpack(i,o,L);o+=r.Ellipsoid.packedLength;var u=i[o++],p=i[o++],f=i[o++],h=i[o++],y=i[o++],c=i[o];return e.defined(a)?(a._positions=s,a._ellipsoid=r.Ellipsoid.clone(d,a._ellipsoid),a._width=u,a._height=p,a._extrudedHeight=f,a._cornerType=h,a._granularity=y,a._offsetAttribute=-1===c?void 0:c,a):(k.positions=s,k.width=u,k.height=p,k.extrudedHeight=f,k.cornerType=h,k.granularity=y,k.offsetAttribute=-1===c?void 0:c,new w(k))},w.createGeometry=function(t){var a=t._positions,n=t._width,s=t._ellipsoid;a=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(a,s);var u=c.arrayRemoveDuplicates(a,r.Cartesian3.equalsEpsilon);if(!(u.length<2||n<=0)){var f,h=t._height,b=t._extrudedHeight,g=!i.CesiumMath.equalsEpsilon(h,b,0,i.CesiumMath.EPSILON2),v={ellipsoid:s,positions:u,width:n,cornerType:t._cornerType,granularity:t._granularity,saveAttributes:!1};if(g)v.height=h,v.extrudedHeight=b,v.offsetAttribute=t._offsetAttribute,f=function(t){var i=t.ellipsoid,r=P(C.CorridorGeometryLibrary.computePositions(t),t.cornerType),o=r.wallIndices,a=t.height,n=t.extrudedHeight,s=r.attributes,u=r.indices,f=s.position.values,h=f.length,c=new Float64Array(h);c.set(f);var b,g=new Float64Array(2*h);if(f=m.PolygonPipeline.scaleToGeodeticHeight(f,a,i),c=m.PolygonPipeline.scaleToGeodeticHeight(c,n,i),g.set(f),g.set(c,h),s.position.values=g,h/=3,e.defined(t.offsetAttribute)){var v=new Uint8Array(2*h);if(t.offsetAttribute===y.GeometryOffsetAttribute.TOP)v=y.arrayFill(v,1,0,h);else{var A=t.offsetAttribute===y.GeometryOffsetAttribute.NONE?0:1;v=y.arrayFill(v,A)}s.applyOffset=new d.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:v})}var _=u.length,E=p.IndexDatatype.createTypedArray(g.length/3,2*(_+o.length));E.set(u);var G,T,w=_;for(b=0;b<_;b+=2){var L=u[b],k=u[b+1];E[w++]=L+h,E[w++]=k+h}for(b=0;b<o.length;b++)T=(G=o[b])+h,E[w++]=G,E[w++]=T;return{attributes:s,indices:E}}(v);else if((f=P(C.CorridorGeometryLibrary.computePositions(v),v.cornerType)).attributes.position.values=m.PolygonPipeline.scaleToGeodeticHeight(f.attributes.position.values,h,s),e.defined(t._offsetAttribute)){var A=f.attributes.position.values.length,_=new Uint8Array(A/3),E=t._offsetAttribute===y.GeometryOffsetAttribute.NONE?0:1;y.arrayFill(_,E),f.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}var G=f.attributes,T=o.BoundingSphere.fromVertices(G.position.values,void 0,3);return new d.Geometry({attributes:G,indices:f.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:T,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=w.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),w.createGeometry(t)}}));
//# sourceMappingURL=createCorridorOutlineGeometry.js.map

define(["./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Ellipsoid-1cbb4ac9","./Transforms-c20c38d0","./RuntimeError-5b606d78","./Cartesian2-73569d25","./WebGLConstants-30fc6f5c","./ComponentDatatype-a863af81","./GeometryAttribute-6b3c7112","./GeometryAttributes-cb18da36","./IndexDatatype-f12d39b5","./GeometryOffsetAttribute-5cfc2755","./EllipsoidRhumbLine-01425f3c","./PolygonPipeline-5110db34","./RectangleGeometryLibrary-47979a32"],(function(e,t,i,r,a,n,o,l,u,s,d,p,c,f,g,h){"use strict";var y=new a.BoundingSphere,m=new a.BoundingSphere,b=new r.Cartesian3,v=new o.Rectangle;function _(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,l=r,c=2,f=0,g=4;n&&(c-=1,l-=1,f+=1,g-=2),o&&(c-=1,l-=1,f+=1,g-=2),f+=c*a+2*l-g;var y,m=new Float64Array(3*f),v=0,_=0,E=b;if(n)h.RectangleGeometryLibrary.computePosition(t,i,!1,_,0,E),m[v++]=E.x,m[v++]=E.y,m[v++]=E.z;else for(y=0;y<a;y++)h.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,E),m[v++]=E.x,m[v++]=E.y,m[v++]=E.z;for(y=a-1,_=1;_<r;_++)h.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,E),m[v++]=E.x,m[v++]=E.y,m[v++]=E.z;if(_=r-1,!o)for(y=a-2;y>=0;y--)h.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,E),m[v++]=E.x,m[v++]=E.y,m[v++]=E.z;for(y=0,_=r-2;_>0;_--)h.RectangleGeometryLibrary.computePosition(t,i,!1,_,y,E),m[v++]=E.x,m[v++]=E.y,m[v++]=E.z;for(var A=m.length/3*2,w=p.IndexDatatype.createTypedArray(m.length/3,A),G=0,R=0;R<m.length/3-1;R++)w[G++]=R,w[G++]=R+1;w[G++]=m.length/3-1,w[G++]=0;var P=new s.Geometry({attributes:new d.GeometryAttributes,primitiveType:s.PrimitiveType.LINES});return P.attributes.position=new s.GeometryAttribute({componentDatatype:u.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m}),P.indices=w,P}function E(a){var n=(a=e.defaultValue(a,e.defaultValue.EMPTY_OBJECT)).rectangle,l=e.defaultValue(a.granularity,i.CesiumMath.RADIANS_PER_DEGREE),u=e.defaultValue(a.ellipsoid,r.Ellipsoid.WGS84),s=e.defaultValue(a.rotation,0);if(!e.defined(n))throw new t.DeveloperError("rectangle is required.");if(o.Rectangle.validate(n),n.north<n.south)throw new t.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var d=e.defaultValue(a.height,0),p=e.defaultValue(a.extrudedHeight,d);this._rectangle=o.Rectangle.clone(n),this._granularity=l,this._ellipsoid=u,this._surfaceHeight=Math.max(d,p),this._rotation=s,this._extrudedHeight=Math.min(d,p),this._offsetAttribute=a.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}E.packedLength=o.Rectangle.packedLength+r.Ellipsoid.packedLength+5,E.pack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("value is required");if(!e.defined(a))throw new t.DeveloperError("array is required");return n=e.defaultValue(n,0),o.Rectangle.pack(i._rectangle,a,n),n+=o.Rectangle.packedLength,r.Ellipsoid.pack(i._ellipsoid,a,n),n+=r.Ellipsoid.packedLength,a[n++]=i._granularity,a[n++]=i._surfaceHeight,a[n++]=i._rotation,a[n++]=i._extrudedHeight,a[n]=e.defaultValue(i._offsetAttribute,-1),a};var A=new o.Rectangle,w=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),G={rectangle:A,ellipsoid:w,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};E.unpack=function(i,a,n){if(!e.defined(i))throw new t.DeveloperError("array is required");a=e.defaultValue(a,0);var l=o.Rectangle.unpack(i,a,A);a+=o.Rectangle.packedLength;var u=r.Ellipsoid.unpack(i,a,w);a+=r.Ellipsoid.packedLength;var s=i[a++],d=i[a++],p=i[a++],c=i[a++],f=i[a];return e.defined(n)?(n._rectangle=o.Rectangle.clone(l,n._rectangle),n._ellipsoid=r.Ellipsoid.clone(u,n._ellipsoid),n._surfaceHeight=d,n._rotation=p,n._extrudedHeight=c,n._offsetAttribute=-1===f?void 0:f,n):(G.granularity=s,G.height=d,G.rotation=p,G.extrudedHeight=c,G.offsetAttribute=-1===f?void 0:f,new E(G))};var R=new r.Cartographic;return E.createGeometry=function(t){var r,n,o=t._rectangle,l=t._ellipsoid,d=h.RectangleGeometryLibrary.computeOptions(o,t._granularity,t._rotation,0,v,R);if(!i.CesiumMath.equalsEpsilon(o.north,o.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(o.east,o.west,i.CesiumMath.EPSILON10)){var f,b=t._surfaceHeight,E=t._extrudedHeight;if(!i.CesiumMath.equalsEpsilon(b,E,0,i.CesiumMath.EPSILON2)){if(r=function(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=_(e,t),u=t.height,s=t.width,d=g.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1),c=d.length,f=new Float64Array(2*c);f.set(d);var h=g.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a);f.set(h,c),l.attributes.position.values=f;var y=t.northCap,m=t.southCap,b=4;y&&(b-=1),m&&(b-=1);var v=2*(f.length/3+b),E=p.IndexDatatype.createTypedArray(f.length/3,v);c=f.length/6;for(var A,w=0,G=0;G<c-1;G++)E[w++]=G,E[w++]=G+1,E[w++]=G+c,E[w++]=G+c+1;if(E[w++]=c-1,E[w++]=0,E[w++]=c+c-1,E[w++]=c,E[w++]=0,E[w++]=c,y)A=u-1;else{var R=s-1;E[w++]=R,E[w++]=R+c,A=s+u-2}if(E[w++]=A,E[w++]=A+c,!m){var P=s+A-1;E[w++]=P,E[w]=P+c}return l.indices=E,l}(t,d),e.defined(t._offsetAttribute)){var A=r.attributes.position.values.length/3,w=new Uint8Array(A);t._offsetAttribute===c.GeometryOffsetAttribute.TOP?w=c.arrayFill(w,1,0,A/2):(f=t._offsetAttribute===c.GeometryOffsetAttribute.NONE?0:1,w=c.arrayFill(w,f)),r.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:u.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var G=a.BoundingSphere.fromRectangle3D(o,l,b,m),P=a.BoundingSphere.fromRectangle3D(o,l,E,y);n=a.BoundingSphere.union(G,P)}else{if((r=_(t,d)).attributes.position.values=g.PolygonPipeline.scaleToGeodeticHeight(r.attributes.position.values,b,l,!1),e.defined(t._offsetAttribute)){var D=r.attributes.position.values.length,L=new Uint8Array(D/3);f=t._offsetAttribute===c.GeometryOffsetAttribute.NONE?0:1,c.arrayFill(L,f),r.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:u.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}n=a.BoundingSphere.fromRectangle3D(o,l,b)}return new s.Geometry({attributes:r.attributes,indices:r.indices,primitiveType:s.PrimitiveType.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=E.unpack(t,i)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),t._rectangle=o.Rectangle.clone(t._rectangle),E.createGeometry(t)}}));
//# sourceMappingURL=createRectangleOutlineGeometry.js.map

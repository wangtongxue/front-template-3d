define(["exports","./when-7ef6387a","./Check-ed6a1804","./Ellipsoid-911f8bc2","./Transforms-d8f9dcbd","./Cartesian2-ff47d58f","./IntersectionTests-c6e3245b","./Plane-02009bbb"],(function(e,n,t,i,a,r,s,o){"use strict";function c(e,t,a){this.minimum=i.Cartesian3.clone(n.defaultValue(e,i.Cartesian3.ZERO)),this.maximum=i.Cartesian3.clone(n.defaultValue(t,i.Cartesian3.ZERO)),a=n.defined(a)?i.Cartesian3.clone(a):i.Cartesian3.midpoint(this.minimum,this.maximum,new i.Cartesian3),this.center=a}c.fromPoints=function(e,t){if(n.defined(t)||(t=new c),!n.defined(e)||0===e.length)return t.minimum=i.Cartesian3.clone(i.Cartesian3.ZERO,t.minimum),t.maximum=i.Cartesian3.clone(i.Cartesian3.ZERO,t.maximum),t.center=i.Cartesian3.clone(i.Cartesian3.ZERO,t.center),t;for(var a=e[0].x,r=e[0].y,s=e[0].z,o=e[0].x,l=e[0].y,m=e[0].z,d=e.length,u=1;u<d;u++){var f=e[u],h=f.x,C=f.y,p=f.z;a=Math.min(h,a),o=Math.max(h,o),r=Math.min(C,r),l=Math.max(C,l),s=Math.min(p,s),m=Math.max(p,m)}var x=t.minimum;x.x=a,x.y=r,x.z=s;var y=t.maximum;return y.x=o,y.y=l,y.z=m,t.center=i.Cartesian3.midpoint(x,y,t.center),t},c.clone=function(e,t){if(n.defined(e))return n.defined(t)?(t.minimum=i.Cartesian3.clone(e.minimum,t.minimum),t.maximum=i.Cartesian3.clone(e.maximum,t.maximum),t.center=i.Cartesian3.clone(e.center,t.center),t):new c(e.minimum,e.maximum,e.center)},c.equals=function(e,t){return e===t||n.defined(e)&&n.defined(t)&&i.Cartesian3.equals(e.center,t.center)&&i.Cartesian3.equals(e.minimum,t.minimum)&&i.Cartesian3.equals(e.maximum,t.maximum)};var l=new i.Cartesian3;c.intersectPlane=function(e,n){t.Check.defined("box",e),t.Check.defined("plane",n),l=i.Cartesian3.subtract(e.maximum,e.minimum,l);var r=i.Cartesian3.multiplyByScalar(l,.5,l),s=n.normal,o=r.x*Math.abs(s.x)+r.y*Math.abs(s.y)+r.z*Math.abs(s.z),c=i.Cartesian3.dot(e.center,s)+n.distance;return c-o>0?a.Intersect.INSIDE:c+o<0?a.Intersect.OUTSIDE:a.Intersect.INTERSECTING},c.prototype.clone=function(e){return c.clone(this,e)},c.prototype.intersectPlane=function(e){return c.intersectPlane(this,e)},c.prototype.equals=function(e){return c.equals(this,e)};var m=new a.Cartesian4;function d(e,r){if(t.Check.defined("origin",e),e=(r=n.defaultValue(r,i.Ellipsoid.WGS84)).scaleToGeodeticSurface(e),!n.defined(e))throw new t.DeveloperError("origin must not be at the center of the ellipsoid.");var s=a.Transforms.eastNorthUpToFixedFrame(e,r);this._ellipsoid=r,this._origin=e,this._xAxis=i.Cartesian3.fromCartesian4(a.Matrix4.getColumn(s,0,m)),this._yAxis=i.Cartesian3.fromCartesian4(a.Matrix4.getColumn(s,1,m));var c=i.Cartesian3.fromCartesian4(a.Matrix4.getColumn(s,2,m));this._plane=o.Plane.fromPointNormal(e,c)}Object.defineProperties(d.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var u=new c;d.fromPoints=function(e,n){return t.Check.defined("cartesians",e),new d(c.fromPoints(e,u).center,n)};var f=new s.Ray,h=new i.Cartesian3;d.prototype.projectPointOntoPlane=function(e,a){t.Check.defined("cartesian",e);var o=f;o.origin=e,i.Cartesian3.normalize(e,o.direction);var c=s.IntersectionTests.rayPlane(o,this._plane,h);if(n.defined(c)||(i.Cartesian3.negate(o.direction,o.direction),c=s.IntersectionTests.rayPlane(o,this._plane,h)),n.defined(c)){var l=i.Cartesian3.subtract(c,this._origin,c),m=i.Cartesian3.dot(this._xAxis,l),d=i.Cartesian3.dot(this._yAxis,l);return n.defined(a)?(a.x=m,a.y=d,a):new r.Cartesian2(m,d)}},d.prototype.projectPointsOntoPlane=function(e,i){t.Check.defined("cartesians",e),n.defined(i)||(i=[]);for(var a=0,r=e.length,s=0;s<r;s++){var o=this.projectPointOntoPlane(e[s],i[a]);n.defined(o)&&(i[a]=o,a++)}return i.length=a,i},d.prototype.projectPointToNearestOnPlane=function(e,a){t.Check.defined("cartesian",e),n.defined(a)||(a=new r.Cartesian2);var o=f;o.origin=e,i.Cartesian3.clone(this._plane.normal,o.direction);var c=s.IntersectionTests.rayPlane(o,this._plane,h);n.defined(c)||(i.Cartesian3.negate(o.direction,o.direction),c=s.IntersectionTests.rayPlane(o,this._plane,h));var l=i.Cartesian3.subtract(c,this._origin,c),m=i.Cartesian3.dot(this._xAxis,l),d=i.Cartesian3.dot(this._yAxis,l);return a.x=m,a.y=d,a},d.prototype.projectPointsToNearestOnPlane=function(e,i){t.Check.defined("cartesians",e),n.defined(i)||(i=[]);var a=e.length;i.length=a;for(var r=0;r<a;r++)i[r]=this.projectPointToNearestOnPlane(e[r],i[r]);return i};var C=new i.Cartesian3;d.prototype.projectPointOntoEllipsoid=function(e,a){t.Check.defined("cartesian",e),n.defined(a)||(a=new i.Cartesian3);var r=this._ellipsoid,s=this._origin,o=this._xAxis,c=this._yAxis,l=C;return i.Cartesian3.multiplyByScalar(o,e.x,l),a=i.Cartesian3.add(s,l,a),i.Cartesian3.multiplyByScalar(c,e.y,l),i.Cartesian3.add(a,l,a),r.scaleToGeocentricSurface(a,a),a},d.prototype.projectPointsOntoEllipsoid=function(e,i){t.Check.defined("cartesians",e);var a=e.length;n.defined(i)?i.length=a:i=new Array(a);for(var r=0;r<a;++r)i[r]=this.projectPointOntoEllipsoid(e[r],i[r]);return i},e.AxisAlignedBoundingBox=c,e.EllipsoidTangentPlane=d}));
//# sourceMappingURL=EllipsoidTangentPlane-dfb29add.js.map

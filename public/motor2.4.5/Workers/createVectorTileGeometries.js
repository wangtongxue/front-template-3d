define(["./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Ellipsoid-1cbb4ac9","./Transforms-c20c38d0","./RuntimeError-5b606d78","./Cartesian2-73569d25","./WebGLConstants-30fc6f5c","./ComponentDatatype-a863af81","./GeometryAttribute-6b3c7112","./GeometryAttributes-cb18da36","./IndexDatatype-f12d39b5","./createTaskProcessorWorker","./GeometryOffsetAttribute-5cfc2755","./VertexFormat-d75df48f","./BoxGeometry-dda23bc9","./CylinderGeometryLibrary-e2d41c6a","./CylinderGeometry-60c5206b","./EllipsoidGeometry-e3bd24e1","./Color-5decb6de"],(function(e,t,n,r,a,i,o,d,s,c,f,l,u,h,b,p,y,x,g,v){"use strict";function C(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}var m=new r.Cartesian3,I=a.Matrix4.packedLength+r.Cartesian3.packedLength,k=a.Matrix4.packedLength+2,M=a.Matrix4.packedLength+r.Cartesian3.packedLength,B=r.Cartesian3.packedLength+1,w={modelMatrix:new a.Matrix4,boundingVolume:new a.BoundingSphere};function A(e,t){var n=t*I,i=r.Cartesian3.unpack(e,n,m);n+=r.Cartesian3.packedLength;var o=a.Matrix4.unpack(e,n,w.modelMatrix);a.Matrix4.multiplyByScale(o,i,o);var d=w.boundingVolume;return r.Cartesian3.clone(r.Cartesian3.ZERO,d.center),d.radius=Math.sqrt(3),w}function O(e,t){var n=t*k,i=e[n++],o=e[n++],d=r.Cartesian3.fromElements(i,i,o,m),s=a.Matrix4.unpack(e,n,w.modelMatrix);a.Matrix4.multiplyByScale(s,d,s);var c=w.boundingVolume;return r.Cartesian3.clone(r.Cartesian3.ZERO,c.center),c.radius=Math.sqrt(2),w}function L(e,t){var n=t*M,i=r.Cartesian3.unpack(e,n,m);n+=r.Cartesian3.packedLength;var o=a.Matrix4.unpack(e,n,w.modelMatrix);a.Matrix4.multiplyByScale(o,i,o);var d=w.boundingVolume;return r.Cartesian3.clone(r.Cartesian3.ZERO,d.center),d.radius=1,w}function E(e,t){var n=t*B,i=e[n++],o=r.Cartesian3.unpack(e,n,m),d=a.Matrix4.fromTranslation(o,w.modelMatrix);a.Matrix4.multiplyByUniformScale(d,i,d);var s=w.boundingVolume;return r.Cartesian3.clone(r.Cartesian3.ZERO,s.center),s.radius=1,w}var U=new r.Cartesian3;function G(t,n,i,o,d){if(e.defined(n)){for(var s=i.length,c=o.attributes.position.values,f=o.indices,l=t.positions,u=t.vertexBatchIds,h=t.indices,b=t.batchIds,p=t.batchTableColors,y=t.batchedIndices,x=t.indexOffsets,g=t.indexCounts,m=t.boundingVolumes,I=t.modelMatrix,k=t.center,M=t.positionOffset,B=t.batchIdIndex,w=t.indexOffset,A=t.batchedIndicesOffset,O=0;O<s;++O){var L=d(n,O),E=L.modelMatrix;a.Matrix4.multiply(I,E,E);for(var G=i[O],S=c.length,T=0;T<S;T+=3){var V=r.Cartesian3.unpack(c,T,U);a.Matrix4.multiplyByPoint(E,V,V),r.Cartesian3.subtract(V,k,V),r.Cartesian3.pack(V,l,3*M+T),u[B++]=G}for(var F=f.length,R=0;R<F;++R)h[w+R]=f[R]+M;var Z=O+A;y[Z]=new C({offset:w,count:F,color:v.Color.fromRgba(p[G]),batchIds:[G]}),b[Z]=G,x[Z]=w,g[Z]=F,m[Z]=a.BoundingSphere.transform(L.boundingVolume,E),M+=S/3,w+=F}t.positionOffset=M,t.batchIdIndex=B,t.indexOffset=w,t.batchedIndicesOffset+=s}}var S=new r.Cartesian3,T=new a.Matrix4;function V(e,t,n){var r=n.length,i=2+r*a.BoundingSphere.packedLength+1+function(e){for(var t=e.length,n=0,r=0;r<t;++r)n+=v.Color.packedLength+3+e[r].batchIds.length;return n}(t),o=new Float64Array(i),d=0;o[d++]=e,o[d++]=r;for(var s=0;s<r;++s)a.BoundingSphere.pack(n[s],o,d),d+=a.BoundingSphere.packedLength;var c=t.length;o[d++]=c;for(var f=0;f<c;++f){var l=t[f];v.Color.pack(l.color,o,d),d+=v.Color.packedLength,o[d++]=l.offset,o[d++]=l.count;var u=l.batchIds,h=u.length;o[d++]=h;for(var b=0;b<h;++b)o[d++]=u[b]}return o}return u((function(t,n){var i=e.defined(t.boxes)?new Float32Array(t.boxes):void 0,o=e.defined(t.boxBatchIds)?new Uint16Array(t.boxBatchIds):void 0,d=e.defined(t.cylinders)?new Float32Array(t.cylinders):void 0,s=e.defined(t.cylinderBatchIds)?new Uint16Array(t.cylinderBatchIds):void 0,c=e.defined(t.ellipsoids)?new Float32Array(t.ellipsoids):void 0,f=e.defined(t.ellipsoidBatchIds)?new Uint16Array(t.ellipsoidBatchIds):void 0,u=e.defined(t.spheres)?new Float32Array(t.spheres):void 0,h=e.defined(t.sphereBatchIds)?new Uint16Array(t.sphereBatchIds):void 0,b=e.defined(i)?o.length:0,y=e.defined(d)?s.length:0,v=e.defined(c)?f.length:0,C=e.defined(u)?h.length:0,m=p.BoxGeometry.getUnitBox(),I=x.CylinderGeometry.getUnitCylinder(),k=g.EllipsoidGeometry.getUnitEllipsoid(),M=m.attributes.position.values,B=I.attributes.position.values,w=k.attributes.position.values,U=M.length*b;U+=B.length*y,U+=w.length*(v+C);var F=m.indices,R=I.indices,Z=k.indices,D=F.length*b;D+=R.length*y,D+=Z.length*(v+C);var P=new Float32Array(U),q=new Uint16Array(U/3),W=l.IndexDatatype.createTypedArray(U/3,D),_=b+y+v+C,N=new Uint16Array(_),Y=new Array(_),j=new Uint32Array(_),z=new Uint32Array(_),H=new Array(_);!function(e){var t=new Float64Array(e),n=0;r.Cartesian3.unpack(t,n,S),n+=r.Cartesian3.packedLength,a.Matrix4.unpack(t,n,T)}(t.packedBuffer);var J={batchTableColors:new Uint32Array(t.batchTableColors),positions:P,vertexBatchIds:q,indices:W,batchIds:N,batchedIndices:Y,indexOffsets:j,indexCounts:z,boundingVolumes:H,positionOffset:0,batchIdIndex:0,indexOffset:0,batchedIndicesOffset:0,modelMatrix:T,center:S};G(J,i,o,m,A),G(J,d,s,I,O),G(J,c,f,k,L),G(J,u,h,k,E);var K=V(W.BYTES_PER_ELEMENT,Y,H);return n.push(P.buffer,q.buffer,W.buffer),n.push(N.buffer,j.buffer,z.buffer),n.push(K.buffer),{positions:P.buffer,vertexBatchIds:q.buffer,indices:W.buffer,indexOffsets:j.buffer,indexCounts:z.buffer,batchIds:N.buffer,packedBuffer:K.buffer}}))}));
//# sourceMappingURL=createVectorTileGeometries.js.map

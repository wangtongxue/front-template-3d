define(["exports","./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Ellipsoid-1cbb4ac9","./Transforms-c20c38d0","./ComponentDatatype-a863af81","./GeometryAttribute-6b3c7112","./GeometryAttributes-cb18da36","./Plane-6ff6c057","./VertexFormat-d75df48f"],(function(e,t,r,a,i,n,o,s,f,u,d){"use strict";function h(e){this.planes=t.defaultValue(e,[])}var l=[new i.Cartesian3,new i.Cartesian3,new i.Cartesian3];i.Cartesian3.clone(i.Cartesian3.UNIT_X,l[0]),i.Cartesian3.clone(i.Cartesian3.UNIT_Y,l[1]),i.Cartesian3.clone(i.Cartesian3.UNIT_Z,l[2]);var p=new i.Cartesian3,c=new i.Cartesian3,m=new u.Plane(new i.Cartesian3(1,0,0),0);function C(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new h,this._orthographicMatrix=new n.Matrix4}function w(e){if(!(t.defined(e.right)&&t.defined(e.left)&&t.defined(e.top)&&t.defined(e.bottom)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new r.DeveloperError("right must be greater than left.");if(e.bottom>e.top)throw new r.DeveloperError("top must be greater than bottom.");if(e.near<=0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=n.Matrix4.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}h.fromBoundingSphere=function(e,a){if(!t.defined(e))throw new r.DeveloperError("boundingSphere is required.");t.defined(a)||(a=new h);var o=l.length,s=a.planes;s.length=2*o;for(var f=e.center,u=e.radius,d=0,m=0;m<o;++m){var C=l[m],w=s[d],v=s[d+1];t.defined(w)||(w=s[d]=new n.Cartesian4),t.defined(v)||(v=s[d+1]=new n.Cartesian4),i.Cartesian3.multiplyByScalar(C,-u,p),i.Cartesian3.add(f,p,p),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-i.Cartesian3.dot(C,p),i.Cartesian3.multiplyByScalar(C,u,p),i.Cartesian3.add(f,p,p),v.x=-C.x,v.y=-C.y,v.z=-C.z,v.w=-i.Cartesian3.dot(i.Cartesian3.negate(C,c),p),d+=2}return a},h.prototype.computeVisibility=function(e){if(!t.defined(e))throw new r.DeveloperError("boundingVolume is required.");for(var a=this.planes,i=!1,o=0,s=a.length;o<s;++o){var f=e.intersectPlane(u.Plane.fromCartesian4(a[o],m));if(f===n.Intersect.OUTSIDE)return n.Intersect.OUTSIDE;f===n.Intersect.INTERSECTING&&(i=!0)}return i?n.Intersect.INTERSECTING:n.Intersect.INSIDE},h.prototype.computeVisibilityWithPlaneMask=function(e,a){if(!t.defined(e))throw new r.DeveloperError("boundingVolume is required.");if(!t.defined(a))throw new r.DeveloperError("parentPlaneMask is required.");if(a===h.MASK_OUTSIDE||a===h.MASK_INSIDE)return a;for(var i=h.MASK_INSIDE,o=this.planes,s=0,f=o.length;s<f;++s){var d=s<31?1<<s:0;if(!(s<31&&0==(a&d))){var l=e.intersectPlane(u.Plane.fromCartesian4(o[s],m));if(l===n.Intersect.OUTSIDE)return h.MASK_OUTSIDE;l===n.Intersect.INTERSECTING&&(i|=d)}}return i},h.MASK_OUTSIDE=4294967295,h.MASK_INSIDE=0,h.MASK_INDETERMINATE=2147483647,Object.defineProperties(C.prototype,{projectionMatrix:{get:function(){return w(this),this._orthographicMatrix}}});var v=new i.Cartesian3,_=new i.Cartesian3,y=new i.Cartesian3,g=new i.Cartesian3;function x(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new C,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far}function b(e){if(!(t.defined(e.width)&&t.defined(e.aspectRatio)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("width, aspectRatio, near, or far parameters are not set.");var a=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new r.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var i=1/e.aspectRatio;a.right=.5*e.width,a.left=-a.right,a.top=i*a.right,a.bottom=-a.top,a.near=e.near,a.far=e.far}}function E(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new h,this._perspectiveMatrix=new n.Matrix4,this._infinitePerspective=new n.Matrix4}function M(e){if(!(t.defined(e.right)&&t.defined(e.left)&&t.defined(e.top)&&t.defined(e.bottom)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");var a=e.top,i=e.bottom,o=e.right,s=e.left,f=e.near,u=e.far;if(a!==e._top||i!==e._bottom||s!==e._left||o!==e._right||f!==e._near||u!==e._far){if(e.near<=0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._left=s,e._right=o,e._top=a,e._bottom=i,e._near=f,e._far=u,e._perspectiveMatrix=n.Matrix4.computePerspectiveOffCenter(s,o,i,a,f,u,e._perspectiveMatrix),e._infinitePerspective=n.Matrix4.computeInfinitePerspectiveOffCenter(s,o,i,a,f,e._infinitePerspective)}}C.prototype.computeCullingVolume=function(e,a,o){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(a))throw new r.DeveloperError("direction is required.");if(!t.defined(o))throw new r.DeveloperError("up is required.");var s=this._cullingVolume.planes,f=this.top,u=this.bottom,d=this.right,h=this.left,l=this.near,p=this.far,c=i.Cartesian3.cross(a,o,v);i.Cartesian3.normalize(c,c);var m=_;i.Cartesian3.multiplyByScalar(a,l,m),i.Cartesian3.add(e,m,m);var C=y;i.Cartesian3.multiplyByScalar(c,h,C),i.Cartesian3.add(m,C,C);var w=s[0];return t.defined(w)||(w=s[0]=new n.Cartesian4),w.x=c.x,w.y=c.y,w.z=c.z,w.w=-i.Cartesian3.dot(c,C),i.Cartesian3.multiplyByScalar(c,d,C),i.Cartesian3.add(m,C,C),w=s[1],t.defined(w)||(w=s[1]=new n.Cartesian4),w.x=-c.x,w.y=-c.y,w.z=-c.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(c,g),C),i.Cartesian3.multiplyByScalar(o,u,C),i.Cartesian3.add(m,C,C),w=s[2],t.defined(w)||(w=s[2]=new n.Cartesian4),w.x=o.x,w.y=o.y,w.z=o.z,w.w=-i.Cartesian3.dot(o,C),i.Cartesian3.multiplyByScalar(o,f,C),i.Cartesian3.add(m,C,C),w=s[3],t.defined(w)||(w=s[3]=new n.Cartesian4),w.x=-o.x,w.y=-o.y,w.z=-o.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(o,g),C),w=s[4],t.defined(w)||(w=s[4]=new n.Cartesian4),w.x=a.x,w.y=a.y,w.z=a.z,w.w=-i.Cartesian3.dot(a,m),i.Cartesian3.multiplyByScalar(a,p,C),i.Cartesian3.add(e,C,C),w=s[5],t.defined(w)||(w=s[5]=new n.Cartesian4),w.x=-a.x,w.y=-a.y,w.z=-a.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(a,g),C),this._cullingVolume},C.prototype.getPixelDimensions=function(e,a,i,n,o){if(w(this),!t.defined(e)||!t.defined(a))throw new r.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new r.DeveloperError("drawingBufferWidth must be greater than zero.");if(a<=0)throw new r.DeveloperError("drawingBufferHeight must be greater than zero.");if(!t.defined(i))throw new r.DeveloperError("distance is required.");if(!t.defined(n))throw new r.DeveloperError("pixelRatio is required.");if(n<=0)throw new r.DeveloperError("pixelRatio must be greater than zero.");if(!t.defined(o))throw new r.DeveloperError("A result object is required.");var s=n*(this.right-this.left)/e,f=n*(this.top-this.bottom)/a;return o.x=s,o.y=f,o},C.prototype.clone=function(e){return t.defined(e)||(e=new C),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},C.prototype.equals=function(e){return t.defined(e)&&e instanceof C&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},C.prototype.equalsEpsilon=function(e,r,i){return e===this||t.defined(e)&&e instanceof C&&a.CesiumMath.equalsEpsilon(this.right,e.right,r,i)&&a.CesiumMath.equalsEpsilon(this.left,e.left,r,i)&&a.CesiumMath.equalsEpsilon(this.top,e.top,r,i)&&a.CesiumMath.equalsEpsilon(this.bottom,e.bottom,r,i)&&a.CesiumMath.equalsEpsilon(this.near,e.near,r,i)&&a.CesiumMath.equalsEpsilon(this.far,e.far,r,i)},x.packedLength=4,x.pack=function(e,a,i){return r.Check.typeOf.object("value",e),r.Check.defined("array",a),i=t.defaultValue(i,0),a[i++]=e.width,a[i++]=e.aspectRatio,a[i++]=e.near,a[i]=e.far,a},x.unpack=function(e,a,i){return r.Check.defined("array",e),a=t.defaultValue(a,0),t.defined(i)||(i=new x),i.width=e[a++],i.aspectRatio=e[a++],i.near=e[a++],i.far=e[a],i},Object.defineProperties(x.prototype,{projectionMatrix:{get:function(){return b(this),this._offCenterFrustum.projectionMatrix}}}),x.prototype.computeCullingVolume=function(e,t,r){return b(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},x.prototype.getPixelDimensions=function(e,t,r,a,i){return b(this),this._offCenterFrustum.getPixelDimensions(e,t,r,a,i)},x.prototype.clone=function(e){return t.defined(e)||(e=new x),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},x.prototype.equals=function(e){return!!(t.defined(e)&&e instanceof x)&&(b(this),b(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},x.prototype.equalsEpsilon=function(e,r,i){return!!(t.defined(e)&&e instanceof x)&&(b(this),b(e),a.CesiumMath.equalsEpsilon(this.width,e.width,r,i)&&a.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,r,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,r,i))},Object.defineProperties(E.prototype,{projectionMatrix:{get:function(){return M(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return M(this),this._infinitePerspective}}});var D=new i.Cartesian3,V=new i.Cartesian3,F=new i.Cartesian3,O=new i.Cartesian3;function z(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new E,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this.xOffset=t.defaultValue(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=t.defaultValue(e.yOffset,0),this._yOffset=this.yOffset}function R(e){if(!(t.defined(e.fov)&&t.defined(e.aspectRatio)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("fov, aspectRatio, near, or far parameters are not set.");var a=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new r.DeveloperError("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new r.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio>1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,a.top=e.near*Math.tan(.5*e._fovy),a.bottom=-a.top,a.right=e.aspectRatio*a.top,a.left=-a.right,a.near=e.near,a.far=e.far,a.right+=e.xOffset,a.left+=e.xOffset,a.top+=e.yOffset,a.bottom+=e.yOffset}}E.prototype.computeCullingVolume=function(e,a,o){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(a))throw new r.DeveloperError("direction is required.");if(!t.defined(o))throw new r.DeveloperError("up is required.");var s=this._cullingVolume.planes,f=this.top,u=this.bottom,d=this.right,h=this.left,l=this.near,p=this.far,c=i.Cartesian3.cross(a,o,D),m=V;i.Cartesian3.multiplyByScalar(a,l,m),i.Cartesian3.add(e,m,m);var C=F;i.Cartesian3.multiplyByScalar(a,p,C),i.Cartesian3.add(e,C,C);var w=O;i.Cartesian3.multiplyByScalar(c,h,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.normalize(w,w),i.Cartesian3.cross(w,o,w),i.Cartesian3.normalize(w,w);var v=s[0];return t.defined(v)||(v=s[0]=new n.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(c,d,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(o,w,w),i.Cartesian3.normalize(w,w),v=s[1],t.defined(v)||(v=s[1]=new n.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(o,u,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(c,w,w),i.Cartesian3.normalize(w,w),v=s[2],t.defined(v)||(v=s[2]=new n.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(o,f,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(w,c,w),i.Cartesian3.normalize(w,w),v=s[3],t.defined(v)||(v=s[3]=new n.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),v=s[4],t.defined(v)||(v=s[4]=new n.Cartesian4),v.x=a.x,v.y=a.y,v.z=a.z,v.w=-i.Cartesian3.dot(a,m),i.Cartesian3.negate(a,w),v=s[5],t.defined(v)||(v=s[5]=new n.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,C),this._cullingVolume},E.prototype.getPixelDimensions=function(e,a,i,n,o){if(M(this),!t.defined(e)||!t.defined(a))throw new r.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new r.DeveloperError("drawingBufferWidth must be greater than zero.");if(a<=0)throw new r.DeveloperError("drawingBufferHeight must be greater than zero.");if(!t.defined(i))throw new r.DeveloperError("distance is required.");if(!t.defined(n))throw new r.DeveloperError("pixelRatio is required");if(n<=0)throw new r.DeveloperError("pixelRatio must be greater than zero.");if(!t.defined(o))throw new r.DeveloperError("A result object is required.");var s=1/this.near,f=this.top*s,u=2*n*i*f/a,d=2*n*i*(f=this.right*s)/e;return o.x=d,o.y=u,o},E.prototype.clone=function(e){return t.defined(e)||(e=new E),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},E.prototype.equals=function(e){return t.defined(e)&&e instanceof E&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},E.prototype.equalsEpsilon=function(e,r,i){return e===this||t.defined(e)&&e instanceof E&&a.CesiumMath.equalsEpsilon(this.right,e.right,r,i)&&a.CesiumMath.equalsEpsilon(this.left,e.left,r,i)&&a.CesiumMath.equalsEpsilon(this.top,e.top,r,i)&&a.CesiumMath.equalsEpsilon(this.bottom,e.bottom,r,i)&&a.CesiumMath.equalsEpsilon(this.near,e.near,r,i)&&a.CesiumMath.equalsEpsilon(this.far,e.far,r,i)},z.packedLength=6,z.pack=function(e,a,i){return r.Check.typeOf.object("value",e),r.Check.defined("array",a),i=t.defaultValue(i,0),a[i++]=e.fov,a[i++]=e.aspectRatio,a[i++]=e.near,a[i++]=e.far,a[i++]=e.xOffset,a[i]=e.yOffset,a},z.unpack=function(e,a,i){return r.Check.defined("array",e),a=t.defaultValue(a,0),t.defined(i)||(i=new z),i.fov=e[a++],i.aspectRatio=e[a++],i.near=e[a++],i.far=e[a++],i.xOffset=e[a++],i.yOffset=e[a],i},Object.defineProperties(z.prototype,{projectionMatrix:{get:function(){return R(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return R(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return R(this),this._fovy}},sseDenominator:{get:function(){return R(this),this._sseDenominator}}}),z.prototype.computeCullingVolume=function(e,t,r){return R(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},z.prototype.getPixelDimensions=function(e,t,r,a,i){return R(this),this._offCenterFrustum.getPixelDimensions(e,t,r,a,i)},z.prototype.clone=function(e){return t.defined(e)||(e=new z),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},z.prototype.equals=function(e){return!!(t.defined(e)&&e instanceof z)&&(R(this),R(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},z.prototype.equalsEpsilon=function(e,r,i){return!!(t.defined(e)&&e instanceof z)&&(R(this),R(e),a.CesiumMath.equalsEpsilon(this.fov,e.fov,r,i)&&a.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,r,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,r,i))};function k(e){r.Check.typeOf.object("options",e),r.Check.typeOf.object("options.frustum",e.frustum),r.Check.typeOf.object("options.origin",e.origin),r.Check.typeOf.object("options.orientation",e.orientation);var a,o,s=e.frustum,f=e.orientation,u=e.origin,h=t.defaultValue(e.vertexFormat,d.VertexFormat.DEFAULT),l=t.defaultValue(e._drawNearPlane,!0);s instanceof z?(a=0,o=z.packedLength):s instanceof x&&(a=1,o=x.packedLength),this._frustumType=a,this._frustum=s.clone(),this._origin=i.Cartesian3.clone(u),this._orientation=n.Quaternion.clone(f),this._drawNearPlane=l,this._vertexFormat=h,this._workerName="createFrustumGeometry",this.packedLength=2+o+i.Cartesian3.packedLength+n.Quaternion.packedLength+d.VertexFormat.packedLength}k.pack=function(e,a,o){r.Check.typeOf.object("value",e),r.Check.defined("array",a),o=t.defaultValue(o,0);var s=e._frustumType,f=e._frustum;return a[o++]=s,0===s?(z.pack(f,a,o),o+=z.packedLength):(x.pack(f,a,o),o+=x.packedLength),i.Cartesian3.pack(e._origin,a,o),o+=i.Cartesian3.packedLength,n.Quaternion.pack(e._orientation,a,o),o+=n.Quaternion.packedLength,d.VertexFormat.pack(e._vertexFormat,a,o),a[o+=d.VertexFormat.packedLength]=e._drawNearPlane?1:0,a};var P=new z,q=new x,S=new n.Quaternion,T=new i.Cartesian3,A=new d.VertexFormat;function I(e,r,a,i,n,o,s,f){for(var u=e/3*2,d=0;d<4;++d)t.defined(r)&&(r[e]=o.x,r[e+1]=o.y,r[e+2]=o.z),t.defined(a)&&(a[e]=s.x,a[e+1]=s.y,a[e+2]=s.z),t.defined(i)&&(i[e]=f.x,i[e+1]=f.y,i[e+2]=f.z),e+=3;n[u]=0,n[u+1]=0,n[u+2]=1,n[u+3]=0,n[u+4]=1,n[u+5]=1,n[u+6]=0,n[u+7]=1}k.unpack=function(e,a,o){r.Check.defined("array",e),a=t.defaultValue(a,0);var s,f=e[a++];0===f?(s=z.unpack(e,a,P),a+=z.packedLength):(s=x.unpack(e,a,q),a+=x.packedLength);var u=i.Cartesian3.unpack(e,a,T);a+=i.Cartesian3.packedLength;var h=n.Quaternion.unpack(e,a,S);a+=n.Quaternion.packedLength;var l=d.VertexFormat.unpack(e,a,A),p=1===e[a+=d.VertexFormat.packedLength];if(!t.defined(o))return new k({frustum:s,origin:u,orientation:h,vertexFormat:l,_drawNearPlane:p});var c=f===o._frustumType?o._frustum:void 0;return o._frustum=s.clone(c),o._frustumType=f,o._origin=i.Cartesian3.clone(u,o._origin),o._orientation=n.Quaternion.clone(h,o._orientation),o._vertexFormat=d.VertexFormat.clone(l,o._vertexFormat),o._drawNearPlane=p,o};var B=new n.Matrix3,L=new n.Matrix4,N=new n.Matrix4,j=new i.Cartesian3,G=new i.Cartesian3,U=new i.Cartesian3,Q=new i.Cartesian3,K=new i.Cartesian3,W=new i.Cartesian3,Y=new Array(3),H=new Array(4);H[0]=new n.Cartesian4(-1,-1,1,1),H[1]=new n.Cartesian4(1,-1,1,1),H[2]=new n.Cartesian4(1,1,1,1),H[3]=new n.Cartesian4(-1,1,1,1);for(var J=new Array(4),X=0;X<4;++X)J[X]=new n.Cartesian4;k._computeNearFarPlanes=function(e,r,a,o,s,f,u,d){var h=n.Matrix3.fromQuaternion(r,B),l=t.defaultValue(f,j),p=t.defaultValue(u,G),c=t.defaultValue(d,U);l=n.Matrix3.getColumn(h,0,l),p=n.Matrix3.getColumn(h,1,p),c=n.Matrix3.getColumn(h,2,c),i.Cartesian3.normalize(l,l),i.Cartesian3.normalize(p,p),i.Cartesian3.normalize(c,c),i.Cartesian3.negate(l,l);var m,C,w=n.Matrix4.computeView(e,c,p,l,L);if(0===a){var v=o.projectionMatrix,_=n.Matrix4.multiply(v,w,N);C=n.Matrix4.inverse(_,N)}else m=n.Matrix4.inverseTransformation(w,N);t.defined(C)?(Y[0]=o.near,Y[1]=o.far):(Y[0]=0,Y[1]=o.near,Y[2]=o.far);for(var y=0;y<2;++y)for(var g=0;g<4;++g){var x=n.Cartesian4.clone(H[g],J[g]);if(t.defined(C)){var b=1/(x=n.Matrix4.multiplyByVector(C,x,x)).w;i.Cartesian3.multiplyByScalar(x,b,x),i.Cartesian3.subtract(x,e,x),i.Cartesian3.normalize(x,x);var E=i.Cartesian3.dot(c,x);i.Cartesian3.multiplyByScalar(x,Y[y]/E,x),i.Cartesian3.add(x,e,x)}else{t.defined(o._offCenterFrustum)&&(o=o._offCenterFrustum);var M=Y[y],D=Y[y+1];x.x=.5*(x.x*(o.right-o.left)+o.left+o.right),x.y=.5*(x.y*(o.top-o.bottom)+o.bottom+o.top),x.z=.5*(x.z*(M-D)-M-D),x.w=1,n.Matrix4.multiplyByVector(m,x,x)}s[12*y+3*g]=x.x,s[12*y+3*g+1]=x.y,s[12*y+3*g+2]=x.z}},k.createGeometry=function(e){var r=e._frustumType,a=e._frustum,u=e._origin,d=e._orientation,h=e._drawNearPlane,l=e._vertexFormat,p=h?6:5,c=new Float64Array(72);k._computeNearFarPlanes(u,d,r,a,c);var m=24;c[m]=c[12],c[m+1]=c[13],c[m+2]=c[14],c[m+3]=c[0],c[m+4]=c[1],c[m+5]=c[2],c[m+6]=c[9],c[m+7]=c[10],c[m+8]=c[11],c[m+9]=c[21],c[m+10]=c[22],c[m+11]=c[23],c[m+=12]=c[15],c[m+1]=c[16],c[m+2]=c[17],c[m+3]=c[3],c[m+4]=c[4],c[m+5]=c[5],c[m+6]=c[0],c[m+7]=c[1],c[m+8]=c[2],c[m+9]=c[12],c[m+10]=c[13],c[m+11]=c[14],c[m+=12]=c[3],c[m+1]=c[4],c[m+2]=c[5],c[m+3]=c[15],c[m+4]=c[16],c[m+5]=c[17],c[m+6]=c[18],c[m+7]=c[19],c[m+8]=c[20],c[m+9]=c[6],c[m+10]=c[7],c[m+11]=c[8],c[m+=12]=c[6],c[m+1]=c[7],c[m+2]=c[8],c[m+3]=c[18],c[m+4]=c[19],c[m+5]=c[20],c[m+6]=c[21],c[m+7]=c[22],c[m+8]=c[23],c[m+9]=c[9],c[m+10]=c[10],c[m+11]=c[11],h||(c=c.subarray(12));var C=new f.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:o.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:c})});if(t.defined(l.normal)||t.defined(l.tangent)||t.defined(l.bitangent)||t.defined(l.st)){var w=t.defined(l.normal)?new Float32Array(12*p):void 0,v=t.defined(l.tangent)?new Float32Array(12*p):void 0,_=t.defined(l.bitangent)?new Float32Array(12*p):void 0,y=t.defined(l.st)?new Float32Array(8*p):void 0,g=j,x=G,b=U,E=i.Cartesian3.negate(g,Q),M=i.Cartesian3.negate(x,K),D=i.Cartesian3.negate(b,W);m=0,h&&(I(m,w,v,_,y,D,g,x),m+=12),I(m,w,v,_,y,b,E,x),I(m+=12,w,v,_,y,E,D,x),I(m+=12,w,v,_,y,M,D,E),I(m+=12,w,v,_,y,g,b,x),I(m+=12,w,v,_,y,x,b,E),t.defined(w)&&(C.normal=new s.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:w})),t.defined(v)&&(C.tangent=new s.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:v})),t.defined(_)&&(C.bitangent=new s.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:_})),t.defined(y)&&(C.st=new s.GeometryAttribute({componentDatatype:o.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:y}))}for(var V=new Uint16Array(6*p),F=0;F<p;++F){var O=6*F,z=4*F;V[O]=z,V[O+1]=z+1,V[O+2]=z+2,V[O+3]=z,V[O+4]=z+2,V[O+5]=z+3}return new s.Geometry({attributes:C,indices:V,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromVertices(c)})},e.FrustumGeometry=k,e.OrthographicFrustum=x,e.PerspectiveFrustum=z}));
//# sourceMappingURL=FrustumGeometry-60892c7f.js.map

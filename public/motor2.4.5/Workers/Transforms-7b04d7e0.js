/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2017 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
define(["exports","./when-4ca4e419","./Check-430b3551","./defineProperties-163ddb68","./Cartesian3-32451e63","./Ellipsoid-d2aa3b12","./Matrix4-33464f2b","./RuntimeError-443472b0","./Cartesian2-f49a1383","./FeatureDetection-0d4fee13"],(function(e,t,r,n,a,i,o,s,u,d){"use strict";function l(e){this._ellipsoid=t.defaultValue(e,i.Ellipsoid.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}n.defineProperties(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),l.prototype.project=function(e,r){var n=this._semimajorAxis,i=e.longitude*n,o=e.latitude*n,s=e.height;return t.defined(r)?(r.x=i,r.y=o,r.z=s,r):new a.Cartesian3(i,o,s)},l.prototype.unproject=function(e,n){if(!t.defined(e))throw new r.DeveloperError("cartesian is required");var a=this._oneOverSemimajorAxis,o=e.x*a,s=e.y*a,u=e.z;return t.defined(n)?(n.longitude=o,n.latitude=s,n.height=u,n):new i.Cartographic(o,s,u)};var c=t.freezeObject({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function f(e,r){this.start=t.defaultValue(e,0),this.stop=t.defaultValue(r,0)}function h(e,r){this.center=a.Cartesian3.clone(t.defaultValue(e,a.Cartesian3.ZERO)),this.radius=t.defaultValue(r,0)}var p=new a.Cartesian3,y=new a.Cartesian3,m=new a.Cartesian3,C=new a.Cartesian3,w=new a.Cartesian3,v=new a.Cartesian3,g=new a.Cartesian3,x=new a.Cartesian3,O=new a.Cartesian3,E=new a.Cartesian3,_=new a.Cartesian3,b=new a.Cartesian3,q=4/3*n.CesiumMath.PI;h.fromPoints=function(e,r){if(t.defined(r)||(r=new h),!t.defined(e)||0===e.length)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var n,i=a.Cartesian3.clone(e[0],g),o=a.Cartesian3.clone(i,p),s=a.Cartesian3.clone(i,y),u=a.Cartesian3.clone(i,m),d=a.Cartesian3.clone(i,C),l=a.Cartesian3.clone(i,w),c=a.Cartesian3.clone(i,v),f=e.length;for(n=1;n<f;n++){a.Cartesian3.clone(e[n],i);var q=i.x,D=i.y,S=i.z;q<o.x&&a.Cartesian3.clone(i,o),q>d.x&&a.Cartesian3.clone(i,d),D<s.y&&a.Cartesian3.clone(i,s),D>l.y&&a.Cartesian3.clone(i,l),S<u.z&&a.Cartesian3.clone(i,u),S>c.z&&a.Cartesian3.clone(i,c)}var R=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(d,o,x)),T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,x)),M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,x)),P=o,A=d,I=R;T>I&&(I=T,P=s,A=l),M>I&&(I=M,P=u,A=c);var U=O;U.x=.5*(P.x+A.x),U.y=.5*(P.y+A.y),U.z=.5*(P.z+A.z);var j=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(A,U,x)),k=Math.sqrt(j),z=E;z.x=o.x,z.y=s.y,z.z=u.z;var N=_;N.x=d.x,N.y=l.y,N.z=c.z;var F=a.Cartesian3.midpoint(z,N,b),V=0;for(n=0;n<f;n++){a.Cartesian3.clone(e[n],i);var L=a.Cartesian3.magnitude(a.Cartesian3.subtract(i,F,x));L>V&&(V=L);var B=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(i,U,x));if(B>j){var W=Math.sqrt(B);j=(k=.5*(k+W))*k;var H=W-k;U.x=(k*U.x+H*i.x)/W,U.y=(k*U.y+H*i.y)/W,U.z=(k*U.z+H*i.z)/W}}return k<V?(a.Cartesian3.clone(U,r.center),r.radius=k):(a.Cartesian3.clone(F,r.center),r.radius=V),r},h.fromInstancePoints=function(e,r,n){if(t.defined(r)||(r=new h),!t.defined(e)||0===n)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var i,o=a.Cartesian3.clone(e[0],g),s=a.Cartesian3.clone(o,p),u=a.Cartesian3.clone(o,y),d=a.Cartesian3.clone(o,m),l=a.Cartesian3.clone(o,C),c=a.Cartesian3.clone(o,w),f=a.Cartesian3.clone(o,v);for(i=1;i<n&&e[i];i++){a.Cartesian3.clone(e[i],o);var q=o.x,D=o.y,S=o.z;q<s.x&&a.Cartesian3.clone(o,s),q>l.x&&a.Cartesian3.clone(o,l),D<u.y&&a.Cartesian3.clone(o,u),D>c.y&&a.Cartesian3.clone(o,c),S<d.z&&a.Cartesian3.clone(o,d),S>f.z&&a.Cartesian3.clone(o,f)}var R=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,x)),T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,x)),M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,x)),P=s,A=l,I=R;T>I&&(I=T,P=u,A=c),M>I&&(I=M,P=d,A=f);var U=O;U.x=.5*(P.x+A.x),U.y=.5*(P.y+A.y),U.z=.5*(P.z+A.z);var j=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(A,U,x)),k=Math.sqrt(j),z=E;z.x=s.x,z.y=u.y,z.z=d.z;var N=_;N.x=l.x,N.y=c.y,N.z=f.z;var F=a.Cartesian3.midpoint(z,N,b),V=0;for(i=0;i<n&&e[i];i++){a.Cartesian3.clone(e[i],o);var L=a.Cartesian3.magnitude(a.Cartesian3.subtract(o,F,x));L>V&&(V=L);var B=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(o,U,x));if(B>j){var W=Math.sqrt(B);j=(k=.5*(k+W))*k;var H=W-k;U.x=(k*U.x+H*o.x)/W,U.y=(k*U.y+H*o.y)/W,U.z=(k*U.z+H*o.z)/W}}return k<V?(a.Cartesian3.clone(U,r.center),r.radius=k):(a.Cartesian3.clone(F,r.center),r.radius=V),r};var D=new l,S=new a.Cartesian3,R=new a.Cartesian3,T=new i.Cartographic,M=new i.Cartographic;h.fromRectangle2D=function(e,t,r){return h.fromRectangleWithHeights2D(e,t,0,0,r)},h.fromRectangleWithHeights2D=function(e,r,n,i,o){if(t.defined(o)||(o=new h),!t.defined(e))return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;r=t.defaultValue(r,D),u.Rectangle.southwest(e,T),T.height=n,u.Rectangle.northeast(e,M),M.height=i;var s=r.project(T,S),d=r.project(M,R),l=d.x-s.x,c=d.y-s.y,f=d.z-s.z;o.radius=.5*Math.sqrt(l*l+c*c+f*f);var p=o.center;return p.x=s.x+.5*l,p.y=s.y+.5*c,p.z=s.z+.5*f,o};var P=[];h.fromRectangle3D=function(e,r,n,o){if(r=t.defaultValue(r,i.Ellipsoid.WGS84),n=t.defaultValue(n,0),t.defined(o)||(o=new h),!t.defined(e))return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;var s=u.Rectangle.subsample(e,r,n,P);return h.fromPoints(s,o)},h.fromVertices=function(e,n,i,o){if(t.defined(o)||(o=new h),!t.defined(e)||0===e.length)return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;n=t.defaultValue(n,a.Cartesian3.ZERO),i=t.defaultValue(i,3),r.Check.typeOf.number.greaterThanOrEquals("stride",i,3);var s=g;s.x=e[0]+n.x,s.y=e[1]+n.y,s.z=e[2]+n.z;var u,d=a.Cartesian3.clone(s,p),l=a.Cartesian3.clone(s,y),c=a.Cartesian3.clone(s,m),f=a.Cartesian3.clone(s,C),q=a.Cartesian3.clone(s,w),D=a.Cartesian3.clone(s,v),S=e.length;for(u=0;u<S;u+=i){var R=e[u]+n.x,T=e[u+1]+n.y,M=e[u+2]+n.z;s.x=R,s.y=T,s.z=M,R<d.x&&a.Cartesian3.clone(s,d),R>f.x&&a.Cartesian3.clone(s,f),T<l.y&&a.Cartesian3.clone(s,l),T>q.y&&a.Cartesian3.clone(s,q),M<c.z&&a.Cartesian3.clone(s,c),M>D.z&&a.Cartesian3.clone(s,D)}var P=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,x)),A=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(q,l,x)),I=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(D,c,x)),U=d,j=f,k=P;A>k&&(k=A,U=l,j=q),I>k&&(k=I,U=c,j=D);var z=O;z.x=.5*(U.x+j.x),z.y=.5*(U.y+j.y),z.z=.5*(U.z+j.z);var N=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(j,z,x)),F=Math.sqrt(N),V=E;V.x=d.x,V.y=l.y,V.z=c.z;var L=_;L.x=f.x,L.y=q.y,L.z=D.z;var B=a.Cartesian3.midpoint(V,L,b),W=0;for(u=0;u<S;u+=i){s.x=e[u]+n.x,s.y=e[u+1]+n.y,s.z=e[u+2]+n.z;var H=a.Cartesian3.magnitude(a.Cartesian3.subtract(s,B,x));H>W&&(W=H);var X=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(s,z,x));if(X>N){var Y=Math.sqrt(X);N=(F=.5*(F+Y))*F;var Z=Y-F;z.x=(F*z.x+Z*s.x)/Y,z.y=(F*z.y+Z*s.y)/Y,z.z=(F*z.z+Z*s.z)/Y}}return F<W?(a.Cartesian3.clone(z,o.center),o.radius=F):(a.Cartesian3.clone(B,o.center),o.radius=W),o},h.fromEncodedCartesianVertices=function(e,r,n){if(t.defined(n)||(n=new h),!t.defined(e)||!t.defined(r)||e.length!==r.length||0===e.length)return n.center=a.Cartesian3.clone(a.Cartesian3.ZERO,n.center),n.radius=0,n;var i=g;i.x=e[0]+r[0],i.y=e[1]+r[1],i.z=e[2]+r[2];var o,s=a.Cartesian3.clone(i,p),u=a.Cartesian3.clone(i,y),d=a.Cartesian3.clone(i,m),l=a.Cartesian3.clone(i,C),c=a.Cartesian3.clone(i,w),f=a.Cartesian3.clone(i,v),q=e.length;for(o=0;o<q;o+=3){var D=e[o]+r[o],S=e[o+1]+r[o+1],R=e[o+2]+r[o+2];i.x=D,i.y=S,i.z=R,D<s.x&&a.Cartesian3.clone(i,s),D>l.x&&a.Cartesian3.clone(i,l),S<u.y&&a.Cartesian3.clone(i,u),S>c.y&&a.Cartesian3.clone(i,c),R<d.z&&a.Cartesian3.clone(i,d),R>f.z&&a.Cartesian3.clone(i,f)}var T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,x)),M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,x)),P=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,x)),A=s,I=l,U=T;M>U&&(U=M,A=u,I=c),P>U&&(U=P,A=d,I=f);var j=O;j.x=.5*(A.x+I.x),j.y=.5*(A.y+I.y),j.z=.5*(A.z+I.z);var k=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(I,j,x)),z=Math.sqrt(k),N=E;N.x=s.x,N.y=u.y,N.z=d.z;var F=_;F.x=l.x,F.y=c.y,F.z=f.z;var V=a.Cartesian3.midpoint(N,F,b),L=0;for(o=0;o<q;o+=3){i.x=e[o]+r[o],i.y=e[o+1]+r[o+1],i.z=e[o+2]+r[o+2];var B=a.Cartesian3.magnitude(a.Cartesian3.subtract(i,V,x));B>L&&(L=B);var W=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(i,j,x));if(W>k){var H=Math.sqrt(W);k=(z=.5*(z+H))*z;var X=H-z;j.x=(z*j.x+X*i.x)/H,j.y=(z*j.y+X*i.y)/H,j.z=(z*j.z+X*i.z)/H}}return z<L?(a.Cartesian3.clone(j,n.center),n.radius=z):(a.Cartesian3.clone(V,n.center),n.radius=L),n},h.fromCornerPoints=function(e,n,i){r.Check.typeOf.object("corner",e),r.Check.typeOf.object("oppositeCorner",n),t.defined(i)||(i=new h);var o=a.Cartesian3.midpoint(e,n,i.center);return i.radius=a.Cartesian3.distance(o,n),i},h.fromEllipsoid=function(e,n){return r.Check.typeOf.object("ellipsoid",e),t.defined(n)||(n=new h),a.Cartesian3.clone(a.Cartesian3.ZERO,n.center),n.radius=e.maximumRadius,n};var A=new a.Cartesian3;h.fromBoundingSpheres=function(e,r){if(t.defined(r)||(r=new h),!t.defined(e)||0===e.length)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var n=e.length;if(1===n)return h.clone(e[0],r);if(2===n)return h.union(e[0],e[1],r);var i,o=[];for(i=0;i<n;i++)o.push(e[i].center);var s=(r=h.fromPoints(o,r)).center,u=r.radius;for(i=0;i<n;i++){var d=e[i];u=Math.max(u,a.Cartesian3.distance(s,d.center,A)+d.radius)}return r.radius=u,r};var I=new a.Cartesian3,U=new a.Cartesian3,j=new a.Cartesian3;h.fromOrientedBoundingBox=function(e,n){r.Check.defined("orientedBoundingBox",e),t.defined(n)||(n=new h);var i=e.halfAxes,s=o.Matrix3.getColumn(i,0,I),u=o.Matrix3.getColumn(i,1,U),d=o.Matrix3.getColumn(i,2,j);return a.Cartesian3.add(s,u,s),a.Cartesian3.add(s,d,s),n.center=a.Cartesian3.clone(e.center,n.center),n.radius=a.Cartesian3.magnitude(s),n},h.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.center=a.Cartesian3.clone(e.center,r.center),r.radius=e.radius,r):new h(e.center,e.radius)},h.packedLength=4,h.pack=function(e,n,a){r.Check.typeOf.object("value",e),r.Check.defined("array",n),a=t.defaultValue(a,0);var i=e.center;return n[a++]=i.x,n[a++]=i.y,n[a++]=i.z,n[a]=e.radius,n},h.unpack=function(e,n,a){r.Check.defined("array",e),n=t.defaultValue(n,0),t.defined(a)||(a=new h);var i=a.center;return i.x=e[n++],i.y=e[n++],i.z=e[n++],a.radius=e[n],a};var k=new a.Cartesian3,z=new a.Cartesian3;h.union=function(e,n,i){r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",n),t.defined(i)||(i=new h);var o=e.center,s=e.radius,u=n.center,d=n.radius,l=a.Cartesian3.subtract(u,o,k),c=a.Cartesian3.magnitude(l);if(s>=c+d)return e.clone(i),i;if(d>=c+s)return n.clone(i),i;var f=.5*(s+c+d),p=a.Cartesian3.multiplyByScalar(l,(-s+f)/c,z);return a.Cartesian3.add(p,o,p),a.Cartesian3.clone(p,i.center),i.radius=f,i};var N=new a.Cartesian3;h.expand=function(e,t,n){r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("point",t),n=h.clone(e,n);var i=a.Cartesian3.magnitude(a.Cartesian3.subtract(t,n.center,N));return i>n.radius&&(n.radius=i),n},h.intersectPlane=function(e,t){r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("plane",t);var n=e.center,i=e.radius,o=t.normal,s=a.Cartesian3.dot(o,n)+t.distance;return s<-i?c.OUTSIDE:s<i?c.INTERSECTING:c.INSIDE},h.transform=function(e,n,a){return r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("transform",n),t.defined(a)||(a=new h),a.center=o.Matrix4.multiplyByPoint(n,e.center,a.center),a.radius=o.Matrix4.getMaximumScale(n)*e.radius,a};var F=new a.Cartesian3;h.distanceSquaredTo=function(e,t){r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("cartesian",t);var n=a.Cartesian3.subtract(e.center,t,F);return a.Cartesian3.magnitudeSquared(n)-e.radius*e.radius},h.transformWithoutScale=function(e,n,a){return r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("transform",n),t.defined(a)||(a=new h),a.center=o.Matrix4.multiplyByPoint(n,e.center,a.center),a.radius=e.radius,a};var V=new a.Cartesian3;h.computePlaneDistances=function(e,n,i,o){r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("position",n),r.Check.typeOf.object("direction",i),t.defined(o)||(o=new f);var s=a.Cartesian3.subtract(e.center,n,V),u=a.Cartesian3.dot(i,s);return o.start=u-e.radius,o.stop=u+e.radius,o};for(var L=new a.Cartesian3,B=new a.Cartesian3,W=new a.Cartesian3,H=new a.Cartesian3,X=new a.Cartesian3,Y=new i.Cartographic,Z=new Array(8),G=0;G<8;++G)Z[G]=new a.Cartesian3;var J=new l;function Q(e,r,n,a){this.x=t.defaultValue(e,0),this.y=t.defaultValue(r,0),this.z=t.defaultValue(n,0),this.w=t.defaultValue(a,0)}h.projectTo2D=function(e,n,i){r.Check.typeOf.object("sphere",e);var o=(n=t.defaultValue(n,J)).ellipsoid,s=e.center,u=e.radius,d=o.geodeticSurfaceNormal(s,L),l=a.Cartesian3.cross(a.Cartesian3.UNIT_Z,d,B);a.Cartesian3.normalize(l,l);var c=a.Cartesian3.cross(d,l,W);a.Cartesian3.normalize(c,c),a.Cartesian3.multiplyByScalar(d,u,d),a.Cartesian3.multiplyByScalar(c,u,c),a.Cartesian3.multiplyByScalar(l,u,l);var f=a.Cartesian3.negate(c,X),p=a.Cartesian3.negate(l,H),y=Z,m=y[0];a.Cartesian3.add(d,c,m),a.Cartesian3.add(m,l,m),m=y[1],a.Cartesian3.add(d,c,m),a.Cartesian3.add(m,p,m),m=y[2],a.Cartesian3.add(d,f,m),a.Cartesian3.add(m,p,m),m=y[3],a.Cartesian3.add(d,f,m),a.Cartesian3.add(m,l,m),a.Cartesian3.negate(d,d),m=y[4],a.Cartesian3.add(d,c,m),a.Cartesian3.add(m,l,m),m=y[5],a.Cartesian3.add(d,c,m),a.Cartesian3.add(m,p,m),m=y[6],a.Cartesian3.add(d,f,m),a.Cartesian3.add(m,p,m),m=y[7],a.Cartesian3.add(d,f,m),a.Cartesian3.add(m,l,m);for(var C=y.length,w=0;w<C;++w){var v=y[w];a.Cartesian3.add(s,v,v);var g=o.cartesianToCartographic(v,Y);n.project(g,v)}var x=(s=(i=h.fromPoints(y,i)).center).x,O=s.y,E=s.z;return s.x=E,s.y=x,s.z=O,i},h.isOccluded=function(e,t){return r.Check.typeOf.object("sphere",e),r.Check.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},h.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&a.Cartesian3.equals(e.center,r.center)&&e.radius===r.radius},h.prototype.intersectPlane=function(e){return h.intersectPlane(this,e)},h.prototype.distanceSquaredTo=function(e){return h.distanceSquaredTo(this,e)},h.prototype.computePlaneDistances=function(e,t,r){return h.computePlaneDistances(this,e,t,r)},h.prototype.isOccluded=function(e){return h.isOccluded(this,e)},h.prototype.equals=function(e){return h.equals(this,e)},h.prototype.clone=function(e){return h.clone(this,e)},h.prototype.volume=function(){var e=this.radius;return q*e*e*e};var K=new a.Cartesian3;Q.fromAxisAngle=function(e,n,i){r.Check.typeOf.object("axis",e),r.Check.typeOf.number("angle",n);var o=n/2,s=Math.sin(o),u=(K=a.Cartesian3.normalize(e,K)).x*s,d=K.y*s,l=K.z*s,c=Math.cos(o);return t.defined(i)?(i.x=u,i.y=d,i.z=l,i.w=c,i):new Q(u,d,l,c)};var $=[1,2,0],ee=new Array(3);Q.fromRotationMatrix=function(e,n){var a,i,s,u,d;r.Check.typeOf.object("matrix",e);var l=e[o.Matrix3.COLUMN0ROW0],c=e[o.Matrix3.COLUMN1ROW1],f=e[o.Matrix3.COLUMN2ROW2],h=l+c+f;if(h>0)d=.5*(a=Math.sqrt(h+1)),a=.5/a,i=(e[o.Matrix3.COLUMN1ROW2]-e[o.Matrix3.COLUMN2ROW1])*a,s=(e[o.Matrix3.COLUMN2ROW0]-e[o.Matrix3.COLUMN0ROW2])*a,u=(e[o.Matrix3.COLUMN0ROW1]-e[o.Matrix3.COLUMN1ROW0])*a;else{var p=0;c>l&&(p=1),f>l&&f>c&&(p=2);var y=$[p],m=$[y];a=Math.sqrt(e[o.Matrix3.getElementIndex(p,p)]-e[o.Matrix3.getElementIndex(y,y)]-e[o.Matrix3.getElementIndex(m,m)]+1);var C=ee;C[p]=.5*a,a=.5/a,d=(e[o.Matrix3.getElementIndex(m,y)]-e[o.Matrix3.getElementIndex(y,m)])*a,C[y]=(e[o.Matrix3.getElementIndex(y,p)]+e[o.Matrix3.getElementIndex(p,y)])*a,C[m]=(e[o.Matrix3.getElementIndex(m,p)]+e[o.Matrix3.getElementIndex(p,m)])*a,i=-C[0],s=-C[1],u=-C[2]}return t.defined(n)?(n.x=i,n.y=s,n.z=u,n.w=d,n):new Q(i,s,u,d)};var te=new Q,re=new Q,ne=new Q,ae=new Q;Q.fromHeadingPitchRoll=function(e,t){return r.Check.typeOf.object("headingPitchRoll",e),ae=Q.fromAxisAngle(a.Cartesian3.UNIT_X,e.roll,te),ne=Q.fromAxisAngle(a.Cartesian3.UNIT_Y,-e.pitch,t),t=Q.multiply(ne,ae,ne),re=Q.fromAxisAngle(a.Cartesian3.UNIT_Z,-e.heading,te),Q.multiply(re,t,t)};var ie=new a.Cartesian3,oe=new a.Cartesian3,se=new Q,ue=new Q,de=new Q;Q.packedLength=4,Q.pack=function(e,n,a){return r.Check.typeOf.object("value",e),r.Check.defined("array",n),a=t.defaultValue(a,0),n[a++]=e.x,n[a++]=e.y,n[a++]=e.z,n[a]=e.w,n},Q.unpack=function(e,n,a){return r.Check.defined("array",e),n=t.defaultValue(n,0),t.defined(a)||(a=new Q),a.x=e[n],a.y=e[n+1],a.z=e[n+2],a.w=e[n+3],a},Q.packedInterpolationLength=3,Q.convertPackedArrayForInterpolation=function(e,t,r,n){Q.unpack(e,4*r,de),Q.conjugate(de,de);for(var a=0,i=r-t+1;a<i;a++){var o=3*a;Q.unpack(e,4*(t+a),se),Q.multiply(se,de,se),se.w<0&&Q.negate(se,se),Q.computeAxis(se,ie);var s=Q.computeAngle(se);n[o]=ie.x*s,n[o+1]=ie.y*s,n[o+2]=ie.z*s}},Q.unpackInterpolationResult=function(e,r,n,i,o){t.defined(o)||(o=new Q),a.Cartesian3.fromArray(e,0,oe);var s=a.Cartesian3.magnitude(oe);return Q.unpack(r,4*i,ue),0===s?Q.clone(Q.IDENTITY,se):Q.fromAxisAngle(oe,s,se),Q.multiply(se,ue,o)},Q.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.x=e.x,r.y=e.y,r.z=e.z,r.w=e.w,r):new Q(e.x,e.y,e.z,e.w)},Q.conjugate=function(e,t){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},Q.magnitudeSquared=function(e){return r.Check.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},Q.magnitude=function(e){return Math.sqrt(Q.magnitudeSquared(e))},Q.normalize=function(e,t){r.Check.typeOf.object("result",t);var n=1/Q.magnitude(e),a=e.x*n,i=e.y*n,o=e.z*n,s=e.w*n;return t.x=a,t.y=i,t.z=o,t.w=s,t},Q.inverse=function(e,t){r.Check.typeOf.object("result",t);var n=Q.magnitudeSquared(e);return t=Q.conjugate(e,t),Q.multiplyByScalar(t,1/n,t)},Q.add=function(e,t,n){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n),n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},Q.subtract=function(e,t,n){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n),n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},Q.negate=function(e,t){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},Q.dot=function(e,t){return r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},Q.multiply=function(e,t,n){r.Check.typeOf.object("left",e),r.Check.typeOf.object("right",t),r.Check.typeOf.object("result",n);var a=e.x,i=e.y,o=e.z,s=e.w,u=t.x,d=t.y,l=t.z,c=t.w,f=s*u+a*c+i*l-o*d,h=s*d-a*l+i*c+o*u,p=s*l+a*d-i*u+o*c,y=s*c-a*u-i*d-o*l;return n.x=f,n.y=h,n.z=p,n.w=y,n},Q.multiplyByScalar=function(e,t,n){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",n),n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},Q.divideByScalar=function(e,t,n){return r.Check.typeOf.object("quaternion",e),r.Check.typeOf.number("scalar",t),r.Check.typeOf.object("result",n),n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},Q.computeAxis=function(e,t){r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t);var a=e.w;if(Math.abs(a-1)<n.CesiumMath.EPSILON6)return t.x=t.y=t.z=0,t;var i=1/Math.sqrt(1-a*a);return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t},Q.computeAngle=function(e){return r.Check.typeOf.object("quaternion",e),Math.abs(e.w-1)<n.CesiumMath.EPSILON6?0:2*Math.acos(e.w)};var le=new Q;Q.lerp=function(e,t,n,a){return r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",n),r.Check.typeOf.object("result",a),le=Q.multiplyByScalar(t,n,le),a=Q.multiplyByScalar(e,1-n,a),Q.add(le,a,a)};var ce=new Q,fe=new Q,he=new Q;Q.slerp=function(e,t,a,i){r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",a),r.Check.typeOf.object("result",i);var o=Q.dot(e,t),s=t;if(o<0&&(o=-o,s=ce=Q.negate(t,ce)),1-o<n.CesiumMath.EPSILON6)return Q.lerp(e,s,a,i);var u=Math.acos(o);return fe=Q.multiplyByScalar(e,Math.sin((1-a)*u),fe),he=Q.multiplyByScalar(s,Math.sin(a*u),he),i=Q.add(fe,he,i),Q.multiplyByScalar(i,1/Math.sin(u),i)},Q.log=function(e,t){r.Check.typeOf.object("quaternion",e),r.Check.typeOf.object("result",t);var i=n.CesiumMath.acosClamped(e.w),o=0;return 0!==i&&(o=i/Math.sin(i)),a.Cartesian3.multiplyByScalar(e,o,t)},Q.exp=function(e,t){r.Check.typeOf.object("cartesian",e),r.Check.typeOf.object("result",t);var n=a.Cartesian3.magnitude(e),i=0;return 0!==n&&(i=Math.sin(n)/n),t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=Math.cos(n),t};var pe=new a.Cartesian3,ye=new a.Cartesian3,me=new Q,Ce=new Q;Q.computeInnerQuadrangle=function(e,t,n,i){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("q2",n),r.Check.typeOf.object("result",i);var o=Q.conjugate(t,me);Q.multiply(o,n,Ce);var s=Q.log(Ce,pe);Q.multiply(o,e,Ce);var u=Q.log(Ce,ye);return a.Cartesian3.add(s,u,s),a.Cartesian3.multiplyByScalar(s,.25,s),a.Cartesian3.negate(s,s),Q.exp(s,me),Q.multiply(t,me,i)},Q.squad=function(e,t,n,a,i,o){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("s0",n),r.Check.typeOf.object("s1",a),r.Check.typeOf.number("t",i),r.Check.typeOf.object("result",o);var s=Q.slerp(e,t,i,me),u=Q.slerp(n,a,i,Ce);return Q.slerp(s,u,2*i*(1-i),o)};for(var we=new Q,ve=1.9011074535173003,ge=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],xe=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],Oe=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],Ee=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],_e=0;_e<7;++_e){var be=_e+1,qe=2*be+1;ge[_e]=1/(be*qe),xe[_e]=be/qe}function De(e,t,n){r.Check.defined("array",e),r.Check.defined("itemToFind",t),r.Check.defined("comparator",n);for(var a,i,o=0,s=e.length-1;o<=s;)if((i=n(e[a=~~((o+s)/2)],t))<0)o=a+1;else{if(!(i>0))return a;s=a-1}return~(s+1)}function Se(e,t,r,n,a){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=r,this.yPoleOffset=n,this.ut1MinusUtc=a}
/**
    @license
    sprintf.js from the php.js project - https://github.com/kvz/phpjs
    Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

    php.js is copyright 2012 Kevin van Zonneveld.

    Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
    (http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
    (http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
    Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
    Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
    Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
    Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
    L. Rodrigues (http://www.jsfromhell.com), Ash Searle
    (http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
    Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
    Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
    http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
    Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
    (http://webdevhobo.blogspot.com/), marrtins, GeekFG
    (http://geekfg.blogspot.com), Andrea Giammarchi
    (http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
    gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
    Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
    (http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
    Marc Palau, Martin
    (http://www.erlenwiese.de/), Breaking Par Consulting Inc
    (http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
    Chris, Mirek Slugen, saulius, Alfonso Jimenez
    (http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
    Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
    Ariede (http://caioariede.com), Robin, Kankrelune
    (http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
    (http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
    Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
    David, Aman Gupta, Michael White, Public Domain
    (http://www.json.org/json2.js), Steven Levithan
    (http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
    Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
    Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
    (http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
    Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
    Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
    (http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
    (http://javascript.crockford.com), madipta, Slawomir Kaniecki,
    ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
    (http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
    Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
    Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
    (http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
    josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
    Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
    (http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
    (http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
    Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
    (http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
    (http://yass.meetcweb.com), Peter-Paul Koch
    (http://www.quirksmode.org/js/beat.html), Olivier Louvignes
    (http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
    Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
    vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
    Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
    (http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
    B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
    (http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
    Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
    Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
    (http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
    Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
    Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
    sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
    Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
    (http://www.premasolutions.com/), Philippe Jausions
    (http://pear.php.net/user/jausions), Aidan Lister
    (http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
    strcmp, Taras Bogach, jpfle, Alexander Ermolaev
    (http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
    dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
    (http://www.pedrotainha.com), James, Arnout Kazemier
    (http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
    FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
    Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
    daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
    W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
    (http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
    Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
    (http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
    Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
    Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
    (http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
    Russell Walker (http://www.nbill.co.uk/), Jamie Beck
    (http://www.terabit.ca/), setcookie, Michael, YUI Library:
    http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
    http://hacks.bluesmoon.info/strftime/strftime.js, Ben
    (http://benblume.co.uk/), DtTvB
    (http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
    meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
    (http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
    Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
    Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
    Bryan

    Licensed under the MIT (MIT-LICENSE.txt) license.

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
    OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
    ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.
    */function Re(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,r=0,n=t[r++],a=function(e,t,r,n){r||(r=" ");var a=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return n?e+a:a+e},i=function(e,t,r,n,i,o){var s=n-e.length;return s>0&&(e=r||!i?a(e,n,o,r):e.slice(0,t.length)+a("",s,"0",!0)+e.slice(t.length)),e},o=function(e,t,r,n,o,s,u){var d=e>>>0;return e=(r=r&&d&&{2:"0b",8:"0",16:"0x"}[t]||"")+a(d.toString(t),s||0,"0",!1),i(e,r,n,o,u)},s=function(e,t,r,n,a,o){return null!=n&&(e=e.slice(0,n)),i(e,"",t,r,a,o)},u=function(e,n,u,d,l,c,f){var h,p,y,m,C;if("%%"==e)return"%";for(var w=!1,v="",g=!1,x=!1,O=" ",E=u.length,_=0;u&&_<E;_++)switch(u.charAt(_)){case" ":v=" ";break;case"+":v="+";break;case"-":w=!0;break;case"'":O=u.charAt(_+1);break;case"0":g=!0;break;case"#":x=!0}if((d=d?"*"==d?+t[r++]:"*"==d.charAt(0)?+t[d.slice(1,-1)]:+d:0)<0&&(d=-d,w=!0),!isFinite(d))throw new Error("sprintf: (minimum-)width must be finite");switch(c=c?"*"==c?+t[r++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:"fFeE".indexOf(f)>-1?6:"d"==f?0:void 0,C=n?t[n.slice(0,-1)]:t[r++],f){case"s":return s(String(C),w,d,c,g,O);case"c":return s(String.fromCharCode(+C),w,d,c,g);case"b":return o(C,2,x,w,d,c,g);case"o":return o(C,8,x,w,d,c,g);case"x":return o(C,16,x,w,d,c,g);case"X":return o(C,16,x,w,d,c,g).toUpperCase();case"u":return o(C,10,x,w,d,c,g);case"i":case"d":return h=+C||0,C=(p=(h=Math.round(h-h%1))<0?"-":v)+a(String(Math.abs(h)),c,"0",!1),i(C,p,w,d,g);case"e":case"E":case"f":case"F":case"g":case"G":return p=(h=+C)<0?"-":v,y=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())],m=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2],C=p+Math.abs(h)[y](c),i(C,p,w,d,g)[m]();default:return e}};return n.replace(e,u)}function Te(e,t,r,n,a,i,o,s){this.year=e,this.month=t,this.day=r,this.hour=n,this.minute=a,this.second=i,this.millisecond=o,this.isLeapSecond=s}function Me(e){if(null===e||isNaN(e))throw new r.DeveloperError("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}function Pe(e,t){this.julianDate=e,this.offset=t}ge[7]=ve/136,xe[7]=8*ve/17,Q.fastSlerp=function(e,t,n,a){r.Check.typeOf.object("start",e),r.Check.typeOf.object("end",t),r.Check.typeOf.number("t",n),r.Check.typeOf.object("result",a);var i,o=Q.dot(e,t);o>=0?i=1:(i=-1,o=-o);for(var s=o-1,u=1-n,d=n*n,l=u*u,c=7;c>=0;--c)Oe[c]=(ge[c]*d-xe[c])*s,Ee[c]=(ge[c]*l-xe[c])*s;var f=i*n*(1+Oe[0]*(1+Oe[1]*(1+Oe[2]*(1+Oe[3]*(1+Oe[4]*(1+Oe[5]*(1+Oe[6]*(1+Oe[7])))))))),h=u*(1+Ee[0]*(1+Ee[1]*(1+Ee[2]*(1+Ee[3]*(1+Ee[4]*(1+Ee[5]*(1+Ee[6]*(1+Ee[7])))))))),p=Q.multiplyByScalar(e,h,we);return Q.multiplyByScalar(t,f,a),Q.add(p,a,a)},Q.fastSquad=function(e,t,n,a,i,o){r.Check.typeOf.object("q0",e),r.Check.typeOf.object("q1",t),r.Check.typeOf.object("s0",n),r.Check.typeOf.object("s1",a),r.Check.typeOf.number("t",i),r.Check.typeOf.object("result",o);var s=Q.fastSlerp(e,t,i,me),u=Q.fastSlerp(n,a,i,Ce);return Q.fastSlerp(s,u,2*i*(1-i),o)},Q.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.x===r.x&&e.y===r.y&&e.z===r.z&&e.w===r.w},Q.equalsEpsilon=function(e,n,a){return r.Check.typeOf.number("epsilon",a),e===n||t.defined(e)&&t.defined(n)&&Math.abs(e.x-n.x)<=a&&Math.abs(e.y-n.y)<=a&&Math.abs(e.z-n.z)<=a&&Math.abs(e.w-n.w)<=a},Q.ZERO=t.freezeObject(new Q(0,0,0,0)),Q.IDENTITY=t.freezeObject(new Q(0,0,0,1)),Q.prototype.clone=function(e){return Q.clone(this,e)},Q.prototype.equals=function(e){return Q.equals(this,e)},Q.prototype.equalsEpsilon=function(e,t){return Q.equalsEpsilon(this,e,t)},Q.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Ae=t.freezeObject({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),Ie=t.freezeObject({UTC:0,TAI:1}),Ue=new Te,je=[31,28,31,30,31,30,31,31,30,31,30,31];function ke(e,t){return $e.compare(e.julianDate,t.julianDate)}var ze=new Pe;function Ne(e){ze.julianDate=e;var t=$e.leapSeconds,r=De(t,ze,ke);r<0&&(r=~r),r>=t.length&&(r=t.length-1);var n=t[r].offset;r>0&&($e.secondsDifference(t[r].julianDate,e)>n&&(n=t[--r].offset));$e.addSeconds(e,n,e)}function Fe(e,t){ze.julianDate=e;var r=$e.leapSeconds,n=De(r,ze,ke);if(n<0&&(n=~n),0===n)return $e.addSeconds(e,-r[0].offset,t);if(n>=r.length)return $e.addSeconds(e,-r[n-1].offset,t);var a=$e.secondsDifference(r[n].julianDate,e);return 0===a?$e.addSeconds(e,-r[n].offset,t):a<=1?void 0:$e.addSeconds(e,-r[--n].offset,t)}function Ve(e,t,r){var n=t/Ae.SECONDS_PER_DAY|0;return e+=n,(t-=Ae.SECONDS_PER_DAY*n)<0&&(e--,t+=Ae.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=t,r}function Le(e,t,r,n,a,i,o){var s=(t-14)/12|0,u=e+4800+s,d=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;(n-=12)<0&&(n+=24);var l=i+(n*Ae.SECONDS_PER_HOUR+a*Ae.SECONDS_PER_MINUTE+o*Ae.SECONDS_PER_MILLISECOND);return l>=43200&&(d-=1),[d,l]}var Be=/^(\d{4})$/,We=/^(\d{4})-(\d{2})$/,He=/^(\d{4})-?(\d{3})$/,Xe=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Ye=/^(\d{4})-?(\d{2})-?(\d{2})$/,Ze=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Ge=/^(\d{2})(\.\d+)?/.source+Ze.source,Je=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Ze.source,Qe=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Ze.source,Ke="Invalid ISO 8601 date.";function $e(e,r,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=t.defaultValue(e,0),r=t.defaultValue(r,0),n=t.defaultValue(n,Ie.UTC);var a=0|e;Ve(a,r+=(e-a)*Ae.SECONDS_PER_DAY,this),n===Ie.UTC&&Ne(this)}$e.fromGregorianDate=function(e,n){if(!(e instanceof Te))throw new r.DeveloperError("date must be a valid GregorianDate.");var a=Le(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return t.defined(n)?(Ve(a[0],a[1],n),Ne(n),n):new $e(a[0],a[1],Ie.UTC)},$e.fromDate=function(e,n){if(!(e instanceof Date)||isNaN(e.getTime()))throw new r.DeveloperError("date must be a valid JavaScript Date.");var a=Le(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t.defined(n)?(Ve(a[0],a[1],n),Ne(n),n):new $e(a[0],a[1],Ie.UTC)},$e.fromIso8601=function(e,n){if("string"!=typeof e)throw new r.DeveloperError(Ke);var a,i,o,s,u,d=(e=e.replace(",",".")).split("T"),l=1,c=1,f=0,h=0,p=0,y=0,m=d[0],C=d[1];if(!t.defined(m))throw new r.DeveloperError(Ke);if(null!==(d=m.match(Ye))){if((s=m.split("-").length-1)>0&&2!==s)throw new r.DeveloperError(Ke);a=+d[1],l=+d[2],c=+d[3]}else if(null!==(d=m.match(We)))a=+d[1],l=+d[2];else if(null!==(d=m.match(Be)))a=+d[1];else{var w;if(null!==(d=m.match(He))){if(a=+d[1],w=+d[2],o=Me(a),w<1||o&&w>366||!o&&w>365)throw new r.DeveloperError(Ke)}else{if(null===(d=m.match(Xe)))throw new r.DeveloperError(Ke);a=+d[1];var v=+d[2],g=+d[3]||0;if((s=m.split("-").length-1)>0&&(!t.defined(d[3])&&1!==s||t.defined(d[3])&&2!==s))throw new r.DeveloperError(Ke);w=7*v+g-new Date(Date.UTC(a,0,4)).getUTCDay()-3}(i=new Date(Date.UTC(a,0,1))).setUTCDate(w),l=i.getUTCMonth()+1,c=i.getUTCDate()}if(o=Me(a),l<1||l>12||c<1||(2!==l||!o)&&c>je[l-1]||o&&2===l&&c>29)throw new r.DeveloperError(Ke);if(t.defined(C)){if(null!==(d=C.match(Qe))){if((s=C.split(":").length-1)>0&&2!==s&&3!==s)throw new r.DeveloperError(Ke);f=+d[1],h=+d[2],p=+d[3],y=1e3*+(d[4]||0),u=5}else if(null!==(d=C.match(Je))){if((s=C.split(":").length-1)>2)throw new r.DeveloperError(Ke);f=+d[1],h=+d[2],p=60*+(d[3]||0),u=4}else{if(null===(d=C.match(Ge)))throw new r.DeveloperError(Ke);f=+d[1],h=60*+(d[2]||0),u=3}if(h>=60||p>=61||f>24||24===f&&(h>0||p>0||y>0))throw new r.DeveloperError(Ke);var x=d[u],O=+d[u+1],E=+(d[u+2]||0);switch(x){case"+":f-=O,h-=E;break;case"-":f+=O,h+=E;break;case"Z":break;default:h+=new Date(Date.UTC(a,l-1,c,f,h)).getTimezoneOffset()}}var _=60===p;for(_&&p--;h>=60;)h-=60,f++;for(;f>=24;)f-=24,c++;for(i=o&&2===l?29:je[l-1];c>i;)c-=i,++l>12&&(l-=12,a++),i=o&&2===l?29:je[l-1];for(;h<0;)h+=60,f--;for(;f<0;)f+=24,c--;for(;c<1;)--l<1&&(l+=12,a--),c+=i=o&&2===l?29:je[l-1];var b=Le(a,l,c,f,h,p,y);return t.defined(n)?(Ve(b[0],b[1],n),Ne(n)):n=new $e(b[0],b[1],Ie.UTC),_&&$e.addSeconds(n,1,n),n},$e.now=function(e){return $e.fromDate(new Date,e)};var et=new $e(0,0,Ie.TAI);
/**
     * @license
     *
     * Grauw URI utilities
     *
     * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
     *
     * @author Laurens Holst (http://www.grauw.nl/)
     *
     *   Copyright 2012 Laurens Holst
     *
     *   Licensed under the Apache License, Version 2.0 (the "License");
     *   you may not use this file except in compliance with the License.
     *   You may obtain a copy of the License at
     *
     *       http://www.apache.org/licenses/LICENSE-2.0
     *
     *   Unless required by applicable law or agreed to in writing, software
     *   distributed under the License is distributed on an "AS IS" BASIS,
     *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     *   See the License for the specific language governing permissions and
     *   limitations under the License.
     *
     */
function tt(e){if(e instanceof tt)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=rt.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}$e.toGregorianDate=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var a=!1,i=Fe(e,et);t.defined(i)||($e.addSeconds(e,-1,et),i=Fe(et,et),a=!0);var o=i.dayNumber,s=i.secondsOfDay;s>=43200&&(o+=1);var u=o+68569|0,d=4*u/146097|0,l=4e3*((u=u-((146097*d+3)/4|0)|0)+1)/1461001|0,c=80*(u=u-(1461*l/4|0)+31|0)/2447|0,f=u-(2447*c/80|0)|0,h=c+2-12*(u=c/11|0)|0,p=100*(d-49)+l+u|0,y=s/Ae.SECONDS_PER_HOUR|0,m=s-y*Ae.SECONDS_PER_HOUR,C=m/Ae.SECONDS_PER_MINUTE|0,w=0|(m-=C*Ae.SECONDS_PER_MINUTE),v=(m-w)/Ae.SECONDS_PER_MILLISECOND;return(y+=12)>23&&(y-=24),a&&(w+=1),t.defined(n)?(n.year=p,n.month=h,n.day=f,n.hour=y,n.minute=C,n.second=w,n.millisecond=v,n.isLeapSecond=a,n):new Te(p,h,f,y,C,w,v,a)},$e.toDate=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var n=$e.toGregorianDate(e,Ue),a=n.second;return n.isLeapSecond&&(a-=1),new Date(Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,a,n.millisecond))},$e.toIso8601=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var a=$e.toGregorianDate(e,Ue),i=a.year,o=a.month,s=a.day,u=a.hour,d=a.minute,l=a.second,c=a.millisecond;return 1e4===i&&1===o&&1===s&&0===u&&0===d&&0===l&&0===c&&(i=9999,o=12,s=31,u=24),t.defined(n)||0===c?t.defined(n)&&0!==n?Re("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i,o,s,u,d,l,(.01*c).toFixed(n).replace(".","").slice(0,n)):Re("%04d-%02d-%02dT%02d:%02d:%02dZ",i,o,s,u,d,l):Re("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i,o,s,u,d,l,(.01*c).toString().replace(".",""))},$e.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.dayNumber=e.dayNumber,r.secondsOfDay=e.secondsOfDay,r):new $e(e.dayNumber,e.secondsOfDay,Ie.TAI)},$e.compare=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");var a=e.dayNumber-n.dayNumber;return 0!==a?a:e.secondsOfDay-n.secondsOfDay},$e.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.dayNumber===r.dayNumber&&e.secondsOfDay===r.secondsOfDay},$e.equalsEpsilon=function(e,n,a){if(!t.defined(a))throw new r.DeveloperError("epsilon is required.");return e===n||t.defined(e)&&t.defined(n)&&Math.abs($e.secondsDifference(e,n))<=a},$e.totalDays=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");return e.dayNumber+e.secondsOfDay/Ae.SECONDS_PER_DAY},$e.secondsDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");return(e.dayNumber-n.dayNumber)*Ae.SECONDS_PER_DAY+(e.secondsOfDay-n.secondsOfDay)},$e.daysDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");return e.dayNumber-n.dayNumber+(e.secondsOfDay-n.secondsOfDay)/Ae.SECONDS_PER_DAY},$e.computeTaiMinusUtc=function(e){ze.julianDate=e;var t=$e.leapSeconds,r=De(t,ze,ke);return r<0&&(r=~r,--r<0&&(r=0)),t[r].offset},$e.addSeconds=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("seconds is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");return Ve(e.dayNumber,e.secondsOfDay+n,a)},$e.addMinutes=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("minutes is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");var i=e.secondsOfDay+n*Ae.SECONDS_PER_MINUTE;return Ve(e.dayNumber,i,a)},$e.addHours=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("hours is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");var i=e.secondsOfDay+n*Ae.SECONDS_PER_HOUR;return Ve(e.dayNumber,i,a)},$e.addDays=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("days is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");return Ve(e.dayNumber+n,e.secondsOfDay,a)},$e.lessThan=function(e,t){return $e.compare(e,t)<0},$e.lessThanOrEquals=function(e,t){return $e.compare(e,t)<=0},$e.greaterThan=function(e,t){return $e.compare(e,t)>0},$e.greaterThanOrEquals=function(e,t){return $e.compare(e,t)>=0},$e.prototype.clone=function(e){return $e.clone(this,e)},$e.prototype.equals=function(e){return $e.equals(this,e)},$e.prototype.equalsEpsilon=function(e,t){return $e.equalsEpsilon(this,e,t)},$e.prototype.toString=function(){return $e.toIso8601(this)},$e.leapSeconds=[new Pe(new $e(2441317,43210,Ie.TAI),10),new Pe(new $e(2441499,43211,Ie.TAI),11),new Pe(new $e(2441683,43212,Ie.TAI),12),new Pe(new $e(2442048,43213,Ie.TAI),13),new Pe(new $e(2442413,43214,Ie.TAI),14),new Pe(new $e(2442778,43215,Ie.TAI),15),new Pe(new $e(2443144,43216,Ie.TAI),16),new Pe(new $e(2443509,43217,Ie.TAI),17),new Pe(new $e(2443874,43218,Ie.TAI),18),new Pe(new $e(2444239,43219,Ie.TAI),19),new Pe(new $e(2444786,43220,Ie.TAI),20),new Pe(new $e(2445151,43221,Ie.TAI),21),new Pe(new $e(2445516,43222,Ie.TAI),22),new Pe(new $e(2446247,43223,Ie.TAI),23),new Pe(new $e(2447161,43224,Ie.TAI),24),new Pe(new $e(2447892,43225,Ie.TAI),25),new Pe(new $e(2448257,43226,Ie.TAI),26),new Pe(new $e(2448804,43227,Ie.TAI),27),new Pe(new $e(2449169,43228,Ie.TAI),28),new Pe(new $e(2449534,43229,Ie.TAI),29),new Pe(new $e(2450083,43230,Ie.TAI),30),new Pe(new $e(2450630,43231,Ie.TAI),31),new Pe(new $e(2451179,43232,Ie.TAI),32),new Pe(new $e(2453736,43233,Ie.TAI),33),new Pe(new $e(2454832,43234,Ie.TAI),34),new Pe(new $e(2456109,43235,Ie.TAI),35),new Pe(new $e(2457204,43236,Ie.TAI),36),new Pe(new $e(2457754,43237,Ie.TAI),37)],tt.prototype.scheme=null,tt.prototype.authority=null,tt.prototype.path="",tt.prototype.query=null,tt.prototype.fragment=null;var rt=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");tt.prototype.getScheme=function(){return this.scheme},tt.prototype.getAuthority=function(){return this.authority},tt.prototype.getPath=function(){return this.path},tt.prototype.getQuery=function(){return this.query},tt.prototype.getFragment=function(){return this.fragment},tt.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},tt.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},tt.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},tt.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(it,st).replace(nt,ot)),this.path&&(this.path=this.path.replace(nt,ot)),this.query&&(this.query=this.query.replace(nt,ot)),this.fragment&&(this.fragment=this.fragment.replace(nt,ot))};var nt=/%[0-9a-z]{2}/gi,at=/[a-zA-Z0-9\-\._~]/,it=/(.*@)?([^@:]*)(:.*)?/;function ot(e){var t=unescape(e);return at.test(t)?t:e.toUpperCase()}function st(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function ut(e,r){if(null===e||"object"!=typeof e)return e;r=t.defaultValue(r,!1);var n=new e.constructor;for(var a in e)if(e.hasOwnProperty(a)){var i=e[a];r&&(i=ut(i,r)),n[a]=i}return n}function dt(e,r,n){n=t.defaultValue(n,!1);var a,i,o,s={},u=t.defined(e),d=t.defined(r);if(u)for(a in e)e.hasOwnProperty(a)&&(i=e[a],d&&n&&"object"==typeof i&&r.hasOwnProperty(a)?(o=r[a],s[a]="object"==typeof o?dt(i,o,n):i):s[a]=i);if(d)for(a in r)r.hasOwnProperty(a)&&!s.hasOwnProperty(a)&&(o=r[a],s[a]=o);return s}tt.prototype.resolve=function(e){var t=new tt;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},tt.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];n&&t.shift();for(""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),n&&r.unshift(""),this.path=r.join("/")},tt.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e};var lt={};function ct(e,n){if(!t.defined(e))throw new r.DeveloperError("identifier is required.");t.defined(lt[e])||(lt[e]=!0,console.warn(t.defaultValue(n,e)))}function ft(e,n){if(!t.defined(e)||!t.defined(n))throw new r.DeveloperError("identifier and message are required.");ct(e,n)}function ht(e,t){var r;return"undefined"!=typeof document&&(r=document),ht._implementation(e,t,r)}ct.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",ct.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",ct.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",ct.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored",ht._implementation=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("relative uri is required.");if(!t.defined(n)){if(void 0===a)return e;n=t.defaultValue(a.baseURI,a.location.href)}var i=new tt(n);return new tt(e).resolve(i).toString()};var pt,yt=/^blob:/i;function mt(e){return r.Check.typeOf.string("uri",e),yt.test(e)}var Ct=/^data:/i;function wt(e){return r.Check.typeOf.string("uri",e),Ct.test(e)}var vt=Array.isArray;t.defined(vt)||(vt=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var gt=vt;var xt=t.freezeObject({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),Ot=t.freezeObject({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3});function Et(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var r=t.defaultValue(e.throttleByServer,!1),n=r||t.defaultValue(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=t.defaultValue(e.priority,0),this.throttle=n,this.throttleByServer=r,this.type=t.defaultValue(e.type,Ot.OTHER),this.serverKey=void 0,this.state=xt.UNISSUED,this.deferred=void 0,this.cancelled=!1}function _t(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var a=r[n],i=a.indexOf(": ");if(i>0){var o=a.substring(0,i),s=a.substring(i+2);t[o]=s}}return t}(this.responseHeaders))}function bt(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function qt(e,t){return t-e}function Dt(e){r.Check.typeOf.object("options",e),r.Check.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function St(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}Et.prototype.cancel=function(){this.cancelled=!0},Et.prototype.clone=function(e){return t.defined(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new Et(this)},_t.prototype.toString=function(){var e="Request has failed.";return t.defined(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},n.defineProperties(bt.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),bt.prototype.addEventListener=function(e,t){r.Check.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var n=this;return function(){n.removeEventListener(e,t)}},bt.prototype.removeEventListener=function(e,t){r.Check.typeOf.func("listener",e);for(var n=this._listeners,a=this._scopes,i=-1,o=0;o<n.length;o++)if(n[o]===e&&a[o]===t){i=o;break}return-1!==i&&(this._insideRaiseEvent?(this._toRemove.push(i),n[i]=void 0,a[i]=void 0):(n.splice(i,1),a.splice(i,1)),!0)},bt.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var r=this._listeners,n=this._scopes,a=r.length;for(e=0;e<a;e++){var i=r[e];t.defined(i)&&r[e].apply(n[e],arguments)}var o=this._toRemove;if((a=o.length)>0){for(o.sort(qt),e=0;e<a;e++){var s=o[e];r.splice(s,1),n.splice(s,1)}o.length=0}this._insideRaiseEvent=!1},n.defineProperties(Dt.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),Dt.prototype.reserve=function(e){e=t.defaultValue(e,this._length),this._array.length=e},Dt.prototype.heapify=function(e){e=t.defaultValue(e,0);for(var r=this._length,n=this._comparator,a=this._array,i=-1,o=!0;o;){var s=2*(e+1),u=s-1;i=u<r&&n(a[u],a[e])<0?u:e,s<r&&n(a[s],a[i])<0&&(i=s),i!==e?(St(a,i,e),e=i):o=!1}},Dt.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},Dt.prototype.insert=function(e){r.Check.defined("element",e);var n,a=this._array,i=this._comparator,o=this._maximumLength,s=this._length++;for(s<a.length?a[s]=e:a.push(e);0!==s;){var u=Math.floor((s-1)/2);if(!(i(a[s],a[u])<0))break;St(a,s,u),s=u}return t.defined(o)&&this._length>o&&(n=a[o],this._length=o),n},Dt.prototype.pop=function(e){if(e=t.defaultValue(e,0),0!==this._length){r.Check.typeOf.number.lessThan("index",e,this._length);var n=this._array,a=n[e];return St(n,e,--this._length),this.heapify(e),a}};var Rt={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0},Tt=20,Mt=new Dt({comparator:function(e,t){return e.priority-t.priority}});Mt.maximumLength=Tt,Mt.reserve(Tt);var Pt=[],At={},It="undefined"!=typeof document?new tt(document.location.href):new tt,Ut=new bt;function jt(){}function kt(e){t.defined(e.priorityFunction)&&(e.priority=e.priorityFunction())}function zt(e){var r=t.defaultValue(jt.requestsByServer[e],jt.maximumRequestsPerServer);return At[e]<r}function Nt(e){return e.state===xt.UNISSUED&&(e.state=xt.ISSUED,e.deferred=t.when.defer()),e.deferred.promise}function Ft(e){var t=Nt(e);return e.state=xt.ACTIVE,Pt.push(e),++Rt.numberOfActiveRequests,++Rt.numberOfActiveRequestsEver,++At[e.serverKey],e.requestFunction().then(function(e){return function(t){e.state!==xt.CANCELLED&&(--Rt.numberOfActiveRequests,--At[e.serverKey],Ut.raiseEvent(),e.state=xt.RECEIVED,e.deferred.resolve(t))}}(e)).otherwise(function(e){return function(t){e.state!==xt.CANCELLED&&(++Rt.numberOfFailedRequests,--Rt.numberOfActiveRequests,--At[e.serverKey],Ut.raiseEvent(t),e.state=xt.FAILED,e.deferred.reject(t))}}(e)),t}function Vt(e){var r=e.state===xt.ACTIVE;e.state=xt.CANCELLED,++Rt.numberOfCancelledRequests,e.deferred.reject(),r&&(--Rt.numberOfActiveRequests,--At[e.serverKey],++Rt.numberOfCancelledActiveRequests),t.defined(e.cancelFunction)&&e.cancelFunction()}jt.maximumRequests=50,jt.maximumRequestsPerServer=6,jt.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},jt.throttleRequests=!0,jt.debugShowStatistics=!1,jt.requestCompletedEvent=Ut,n.defineProperties(jt,{statistics:{get:function(){return Rt}},priorityHeapLength:{get:function(){return Tt},set:function(e){if(e<Tt)for(;Mt.length>e;){Vt(Mt.pop())}Tt=e,Mt.maximumLength=e,Mt.reserve(e)}}}),jt.update=function(){var e,t,r=0,n=Pt.length;for(e=0;e<n;++e)(t=Pt[e]).cancelled&&Vt(t),t.state===xt.ACTIVE?r>0&&(Pt[e-r]=t):++r;Pt.length-=r;var a=Mt.internalArray,i=Mt.length;for(e=0;e<i;++e)kt(a[e]);Mt.resort();for(var o=Math.max(jt.maximumRequests-Pt.length,0),s=0;s<o&&Mt.length>0;)(t=Mt.pop()).cancelled?Vt(t):!t.throttleByServer||zt(t.serverKey)?(Ft(t),++s):Vt(t);!function(){if(!jt.debugShowStatistics)return;Rt.numberOfAttemptedRequests>0&&console.log("Number of attempted requests: "+Rt.numberOfAttemptedRequests);Rt.numberOfActiveRequests>0&&console.log("Number of active requests: "+Rt.numberOfActiveRequests);Rt.numberOfCancelledRequests>0&&console.log("Number of cancelled requests: "+Rt.numberOfCancelledRequests);Rt.numberOfCancelledActiveRequests>0&&console.log("Number of cancelled active requests: "+Rt.numberOfCancelledActiveRequests);Rt.numberOfFailedRequests>0&&console.log("Number of failed requests: "+Rt.numberOfFailedRequests);Rt.numberOfAttemptedRequests=0,Rt.numberOfCancelledRequests=0,Rt.numberOfCancelledActiveRequests=0}()},jt.getServerKey=function(e){r.Check.typeOf.string("url",e);var n=new tt(e).resolve(It);n.normalize();var a=n.authority;/:/.test(a)||(a=a+":"+("https"===n.scheme?"443":"80"));var i=At[a];return t.defined(i)||(At[a]=0),a},jt.request=function(e){if(r.Check.typeOf.object("request",e),r.Check.typeOf.string("request.url",e.url),r.Check.typeOf.func("request.requestFunction",e.requestFunction),wt(e.url)||mt(e.url))return Ut.raiseEvent(),e.state=xt.RECEIVED,e.requestFunction();if(++Rt.numberOfAttemptedRequests,t.defined(e.serverKey)||(e.serverKey=jt.getServerKey(e.url)),!jt.throttleRequests||!e.throttle)return Ft(e);if(!(Pt.length>=jt.maximumRequests)&&(!e.throttleByServer||zt(e.serverKey))){kt(e);var n=Mt.insert(e);if(t.defined(n)){if(n===e)return;Vt(n)}return Nt(e)}},jt.clearForSpecs=function(){for(;Mt.length>0;){Vt(Mt.pop())}for(var e=Pt.length,t=0;t<e;++t)Vt(Pt[t]);Pt.length=0,At={},Rt.numberOfAttemptedRequests=0,Rt.numberOfActiveRequests=0,Rt.numberOfCancelledRequests=0,Rt.numberOfCancelledActiveRequests=0,Rt.numberOfFailedRequests=0,Rt.numberOfActiveRequestsEver=0},jt.numberOfActiveRequestsByServer=function(e){return At[e]},jt.requestHeap=Mt;var Lt={},Bt={};Lt.add=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var a=e.toLowerCase()+":"+n;t.defined(Bt[a])||(Bt[a]=!0)},Lt.remove=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var a=e.toLowerCase()+":"+n;t.defined(Bt[a])&&delete Bt[a]},Lt.contains=function(e){if(!t.defined(e))throw new r.DeveloperError("url is required.");var n=function(e){var r=new tt(e);r.normalize();var n=r.getAuthority();if(t.defined(n)){if(-1!==n.indexOf("@")){var a=n.split("@");n=a[1]}if(-1===n.indexOf(":")){var i=r.getScheme();if(t.defined(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)n+=":80";else{if("https"!==i)return;n+=":443"}}return n}}(e);return!(!t.defined(n)||!t.defined(Bt[n]))},Lt.clear=function(){Bt={}};var Wt=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Ht(e,n,a,i){var o,s=e.query;if(!t.defined(s)||0===s.length)return{};if(-1===s.indexOf("=")){var u={};u[s]=void 0,o=u}else o=function(e){if(!t.defined(e))throw new r.DeveloperError("queryString is required.");var n={};if(""===e)return n;for(var a=e.replace(/\+/g,"%20").split(/[&;]/),i=0,o=a.length;i<o;++i){var s=a[i].split("="),u=decodeURIComponent(s[0]),d=s[1];d=t.defined(d)?decodeURIComponent(d):"";var l=n[u];"string"==typeof l?n[u]=[l,d]:gt(l)?l.push(d):n[u]=d}return n}(s);n._queryParameters=a?Gt(o,n._queryParameters,i):o,e.query=void 0}function Xt(e,n){var a=n._queryParameters,i=Object.keys(a);1!==i.length||t.defined(a[i[0]])?e.query=function(e){if(!t.defined(e))throw new r.DeveloperError("obj is required.");var n="";for(var a in e)if(e.hasOwnProperty(a)){var i=e[a],o=encodeURIComponent(a)+"=";if(gt(i))for(var s=0,u=i.length;s<u;++s)n+=o+encodeURIComponent(i[s])+"&";else n+=o+encodeURIComponent(i)+"&"}return n=n.slice(0,-1)}(a):e.query=i[0]}function Yt(e,r){return t.defined(e)?t.defined(e.clone)?e.clone():ut(e):r}function Zt(e){if(e.state===xt.ISSUED||e.state===xt.ACTIVE)throw new s.RuntimeError("The Resource is already being fetched.");e.state=xt.UNISSUED,e.deferred=void 0}function Gt(e,r,n){if(!n)return dt(e,r);var a=ut(e,!0);for(var i in r)if(r.hasOwnProperty(i)){var o=a[i],s=r[i];t.defined(o)?(Array.isArray(o)||(o=a[i]=[o]),a[i]=o.concat(s)):a[i]=Array.isArray(s)?s.slice():s}return a}function Jt(e){"string"==typeof(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT))&&(e={url:e}),r.Check.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=Yt(e.templateValues,{}),this._queryParameters=Yt(e.queryParameters,{}),this.headers=Yt(e.headers,{}),this.request=t.defaultValue(e.request,new Et),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=t.defaultValue(e.retryAttempts,0),this._retryCount=0;var n=new tt(e.url);Ht(n,this,!0,!0),n.fragment=void 0,this._url=n.toString()}function Qt(e){var r=e.request;r.url=e.url,r.requestFunction=function(){var r=e.url,n=!1;e.isDataUri||e.isBlobUri||(n=e.isCrossOriginUrl);var a=t.when.defer();return Jt._Implementations.createImage(r,n,a),a.promise};var n=jt.request(r);if(t.defined(n))return n.otherwise((function(n){return r.state!==xt.FAILED?t.when.reject(n):e.retryOnError(n).then((function(a){return a?(r.state=xt.UNISSUED,r.deferred=void 0,Qt(e)):t.when.reject(n)}))}))}Jt.createIfNeeded=function(e){return e instanceof Jt?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Jt({url:e})},n.defineProperties(Jt,{isBlobSupported:{get:function(){return Wt}}}),n.defineProperties(Jt.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new tt(e);Ht(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return function(e){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var n=new tt(e);n.normalize();var a=n.path,i=a.lastIndexOf("/");return-1!==i&&(a=a.substr(i+1)),i=a.lastIndexOf("."),a=-1===i?"":a.substr(i+1)}(this._url)}},isDataUri:{get:function(){return wt(this._url)}},isBlobUri:{get:function(){return mt(this._url)}},isCrossOriginUrl:{get:function(){return function(e){t.defined(pt)||(pt=document.createElement("a")),pt.href=window.location.href;var r=pt.host,n=pt.protocol;return pt.href=e,pt.href=pt.href,n!==pt.protocol||r!==pt.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),Jt.prototype.getUrlComponent=function(e,r){if(this.isDataUri)return this._url;var n=new tt(this._url);e&&Xt(n,this);var a=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),i=this._templateValues,o=Object.keys(i);if(o.length>0)for(var s=0;s<o.length;s++){var u=o[s],d=i[u];a=a.replace(new RegExp("{"+u+"}","g"),encodeURIComponent(d))}return r&&t.defined(this.proxy)&&(a=this.proxy.getURL(a)),a},Jt.prototype.setQueryParameters=function(e,t){this._queryParameters=t?Gt(this._queryParameters,e,!1):Gt(e,this._queryParameters,!1)},Jt.prototype.addQueryParameters=function(e,t){return ft("Resource.addQueryParameters","addQueryParameters has been deprecated and will be removed 1.45. Use setQueryParameters or appendQueryParameters instead."),this.setQueryParameters(e,t)},Jt.prototype.appendQueryParameters=function(e){this._queryParameters=Gt(e,this._queryParameters,!0)},Jt.prototype.setTemplateValues=function(e,t){this._templateValues=t?dt(this._templateValues,e):dt(e,this._templateValues)},Jt.prototype.addTemplateValues=function(e,t){return ft("Resource.addTemplateValues","addTemplateValues has been deprecated and will be removed 1.45. Use setTemplateValues."),this.setTemplateValues(e,t)},Jt.prototype.getDerivedResource=function(e){var r=this.clone();if(r._retryCount=0,t.defined(e.url)){var n=new tt(e.url);Ht(n,r,!0,t.defaultValue(e.preserveQueryParameters,!1)),n.fragment=void 0,r._url=n.resolve(new tt(ht(this._url))).toString()}return t.defined(e.queryParameters)&&(r._queryParameters=dt(e.queryParameters,r._queryParameters)),t.defined(e.templateValues)&&(r._templateValues=dt(e.templateValues,r.templateValues)),t.defined(e.headers)&&(r.headers=dt(e.headers,r.headers)),t.defined(e.proxy)&&(r.proxy=e.proxy),t.defined(e.request)&&(r.request=e.request),t.defined(e.retryCallback)&&(r.retryCallback=e.retryCallback),t.defined(e.retryAttempts)&&(r.retryAttempts=e.retryAttempts),r},Jt.prototype.retryOnError=function(e){var r=this.retryCallback;if("function"!=typeof r||this._retryCount>=this.retryAttempts)return t.when(!1);var n=this;return t.when(r(this,e)).then((function(e){return++n._retryCount,e}))},Jt.prototype.clone=function(e){return t.defined(e)||(e=new Jt({url:this._url})),e._url=this._url,e._queryParameters=ut(this._queryParameters),e._templateValues=ut(this._templateValues),e.headers=ut(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},Jt.prototype.getBaseUri=function(e){return function(e,n){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var a="",i=e.lastIndexOf("/");return-1!==i&&(a=e.substring(0,i+1)),n?(e=new tt(e),t.defined(e.query)&&(a+="?"+e.query),t.defined(e.fragment)&&(a+="#"+e.fragment),a):a}(this.getUrlComponent(e),e)},Jt.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e+="/"),e)},Jt.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Jt.fetchArrayBuffer=function(e){return new Jt(e).fetchArrayBuffer()},Jt.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Jt.fetchBlob=function(e){return new Jt(e).fetchBlob()},Jt.prototype.fetchImage=function(e){if(e=t.defaultValue(e,!1),Zt(this.request),!Wt||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!e)return Qt(this);var r,n,a=this.fetchBlob();return t.defined(a)?a.then((function(e){if(t.defined(e)){n=e;var a=window.URL.createObjectURL(e);return Qt(r=new Jt({url:a}))}})).then((function(e){if(t.defined(e))return window.URL.revokeObjectURL(r.url),e.blob=n,e})).otherwise((function(e){return t.defined(r)&&window.URL.revokeObjectURL(r.url),t.when.reject(e)})):void 0},Jt.fetchImage=function(e){return new Jt(e).fetchImage(e.preferBlob)},Jt.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Jt.fetchText=function(e){return new Jt(e).fetchText()},Jt.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(t.defined(e))return e.then((function(e){if(t.defined(e))return JSON.parse(e)}))},Jt.fetchJson=function(e){return new Jt(e).fetchJson()},Jt.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Jt.fetchXML=function(e){return new Jt(e).fetchXML()},Jt.prototype.fetchJsonp=function(e){var r;e=t.defaultValue(e,"callback"),Zt(this.request);do{r="loadJsonp"+Math.random().toString().substring(2,8)}while(t.defined(window[r]));return function e(r,n,a){var i={};i[n]=a,r.setQueryParameters(i);var o=r.request;o.url=r.url,o.requestFunction=function(){var e=t.when.defer();return window[a]=function(t){e.resolve(t);try{delete window[a]}catch(e){window[a]=void 0}},Jt._Implementations.loadAndExecuteScript(r.url,a,e),e.promise};var s=jt.request(o);if(!t.defined(s))return;return s.otherwise((function(i){return o.state!==xt.FAILED?t.when.reject(i):r.retryOnError(i).then((function(s){return s?(o.state=xt.UNISSUED,o.deferred=void 0,e(r,n,a)):t.when.reject(i)}))}))}(this,e,r)},Jt.fetchJsonp=function(e){return new Jt(e).fetchJsonp(e.callbackParameterName)},Jt.prototype._makeRequest=function(e){var r=this;Zt(r.request);var n=r.request;n.url=r.url,n.requestFunction=function(){var a=e.responseType,i=dt(e.headers,r.headers),o=e.overrideMimeType,s=e.method,u=e.data,d=t.when.defer(),l=Jt._Implementations.loadWithXhr(r.url,a,s,u,i,d,o);return t.defined(l)&&t.defined(l.abort)&&(n.cancelFunction=function(){l.abort()}),d.promise};var a=jt.request(n);if(t.defined(a))return a.then((function(e){return e})).otherwise((function(a){return n.state!==xt.FAILED?t.when.reject(a):r.retryOnError(a).then((function(i){return i?(n.state=xt.UNISSUED,n.deferred=void 0,r.fetch(e)):t.when.reject(a)}))}))};var Kt=/^data:(.*?)(;base64)?,(.*)$/;function $t(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function er(e,t){for(var r=$t(e,t),n=new ArrayBuffer(r.length),a=new Uint8Array(n),i=0;i<r.length;i++)a[i]=r.charCodeAt(i);return n}function tr(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}Jt.prototype.fetch=function(e){return(e=Yt(e,{})).method="GET",this._makeRequest(e)},Jt.fetch=function(e){return new Jt(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt.prototype.delete=function(e){return(e=Yt(e,{})).method="DELETE",this._makeRequest(e)},Jt.delete=function(e){return new Jt(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Jt.prototype.head=function(e){return(e=Yt(e,{})).method="HEAD",this._makeRequest(e)},Jt.head=function(e){return new Jt(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt.prototype.options=function(e){return(e=Yt(e,{})).method="OPTIONS",this._makeRequest(e)},Jt.options=function(e){return new Jt(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt.prototype.post=function(e,t){return r.Check.defined("data",e),(t=Yt(t,{})).method="POST",t.data=e,this._makeRequest(t)},Jt.post=function(e){return new Jt(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt.prototype.put=function(e,t){return r.Check.defined("data",e),(t=Yt(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Jt.put=function(e){return new Jt(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt.prototype.patch=function(e,t){return r.Check.defined("data",e),(t=Yt(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Jt.patch=function(e){return new Jt(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Jt._Implementations={},Jt._Implementations.createImage=function(e,t,r){var n=new Image;n.onload=function(){r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(Lt.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e};var rr="undefined"==typeof XMLHttpRequest;function nr(e){if(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=t.defaultValue(e.addNewLeapSeconds,!0),t.defined(e.data))ir(this,e.data);else if(t.defined(e.url)){var r=Jt.createIfNeeded(e.url),n=this;this._downloadPromise=t.when(r.fetchJson(),(function(e){ir(n,e)}),(function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+r.url+"."}))}else ir(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function ar(e,t){return $e.compare(e.julianDate,t)}function ir(e,r){if(t.defined(r.columnNames))if(t.defined(r.samples)){var n=r.columnNames.indexOf("modifiedJulianDateUtc"),a=r.columnNames.indexOf("xPoleWanderRadians"),i=r.columnNames.indexOf("yPoleWanderRadians"),o=r.columnNames.indexOf("ut1MinusUtcSeconds"),s=r.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=r.columnNames.indexOf("yCelestialPoleOffsetRadians"),d=r.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||a<0||i<0||o<0||s<0||u<0||d<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var l,c=e._samples=r.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=a,e._yPoleWanderRadiansColumn=i,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=d,e._columnCount=r.columnNames.length,e._lastIndex=void 0;for(var h=e._addNewLeapSeconds,p=0,y=c.length;p<y;p+=e._columnCount){var m=c[p+n],C=c[p+d],w=new $e(m+Ae.MODIFIED_JULIAN_DATE_DIFFERENCE,C,Ie.TAI);if(f.push(w),h){if(C!==l&&t.defined(l)){var v=$e.leapSeconds,g=De(v,w,ar);if(g<0){var x=new Pe(w,C);v.splice(~g,0,x)}}l=C}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function or(e,t,r,n,a){var i=r*n;a.xPoleWander=t[i+e._xPoleWanderRadiansColumn],a.yPoleWander=t[i+e._yPoleWanderRadiansColumn],a.xPoleOffset=t[i+e._xCelestialPoleOffsetRadiansColumn],a.yPoleOffset=t[i+e._yCelestialPoleOffsetRadiansColumn],a.ut1MinusUtc=t[i+e._ut1MinusUtcSecondsColumn]}function sr(e,t,r){return t+e*(r-t)}function ur(e,t,r,n,a,i,o){var s=e._columnCount;if(i>t.length-1)return o.xPoleWander=0,o.yPoleWander=0,o.xPoleOffset=0,o.yPoleOffset=0,o.ut1MinusUtc=0,o;var u=t[a],d=t[i];if(u.equals(d)||n.equals(u))return or(e,r,a,s,o),o;if(n.equals(d))return or(e,r,i,s,o),o;var l=$e.secondsDifference(n,u)/$e.secondsDifference(d,u),c=a*s,f=i*s,h=r[c+e._ut1MinusUtcSecondsColumn],p=r[f+e._ut1MinusUtcSecondsColumn],y=p-h;if(y>.5||y<-.5){var m=r[c+e._taiMinusUtcSecondsColumn],C=r[f+e._taiMinusUtcSecondsColumn];m!==C&&(d.equals(n)?h=p:p-=C-m)}return o.xPoleWander=sr(l,r[c+e._xPoleWanderRadiansColumn],r[f+e._xPoleWanderRadiansColumn]),o.yPoleWander=sr(l,r[c+e._yPoleWanderRadiansColumn],r[f+e._yPoleWanderRadiansColumn]),o.xPoleOffset=sr(l,r[c+e._xCelestialPoleOffsetRadiansColumn],r[f+e._xCelestialPoleOffsetRadiansColumn]),o.yPoleOffset=sr(l,r[c+e._yCelestialPoleOffsetRadiansColumn],r[f+e._yCelestialPoleOffsetRadiansColumn]),o.ut1MinusUtc=sr(l,h,p),o}function dr(e,r,n){this.heading=t.defaultValue(e,0),this.pitch=t.defaultValue(r,0),this.roll=t.defaultValue(n,0)}Jt._Implementations.loadWithXhr=function(e,n,a,i,o,u,d){var l=Kt.exec(e);if(null===l){if(!rr){var c=new XMLHttpRequest;if(Lt.contains(e)&&(c.withCredentials=!0),c.open(a,e,!0),t.defined(d)&&t.defined(c.overrideMimeType)&&c.overrideMimeType(d),t.defined(o))for(var f in o)o.hasOwnProperty(f)&&c.setRequestHeader(f,o[f]);t.defined(n)&&(c.responseType=n);var h=!1;return"string"==typeof e&&(h=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),c.onload=function(){if(!(c.status<200||c.status>=300)||h&&0===c.status){var e=c.response,r=c.responseType;if("HEAD"===a||"OPTIONS"===a){var i=c.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return i.forEach((function(e){var t=e.split(": "),r=t.shift();o[r]=t.join(": ")})),void u.resolve(o)}if(204===c.status)u.resolve();else if(!t.defined(e)||t.defined(n)&&r!==n)if("json"===n&&"string"==typeof e)try{u.resolve(JSON.parse(e))}catch(e){u.reject(e)}else(""===r||"document"===r)&&t.defined(c.responseXML)&&c.responseXML.hasChildNodes()?u.resolve(c.responseXML):""!==r&&"text"!==r||!t.defined(c.responseText)?u.reject(new s.RuntimeError("Invalid XMLHttpRequest response type.")):u.resolve(c.responseText);else u.resolve(e)}else u.reject(new _t(c.status,c.response,c.getAllResponseHeaders()))},c.onerror=function(e){u.reject(new _t)},c.send(i),c}!function(e,t,r,n,a,i,o){var u=require("url").parse(e),d="https:"===u.protocol?require("https"):require("http"),l=require("zlib"),c={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:r,headers:a};d.request(c).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)i.reject(new _t(e.statusCode,e,e.headers));else{var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var n=Buffer.concat(r);"gzip"===e.headers["content-encoding"]?l.gunzip(n,(function(e,r){e?i.reject(new s.RuntimeError("Error decompressing response.")):i.resolve(tr(r,t))})):i.resolve(tr(n,t))}))}})).on("error",(function(e){i.reject(new _t)})).end()}(e,n,a,0,o,u)}else u.resolve(function(e,n){n=t.defaultValue(n,"");var a=e[1],i=!!e[2],o=e[3];switch(n){case"":case"text":return $t(i,o);case"arraybuffer":return er(i,o);case"blob":var s=er(i,o);return new Blob([s],{type:a});case"document":return(new DOMParser).parseFromString($t(i,o),a);case"json":return JSON.parse($t(i,o));default:throw new r.DeveloperError("Unhandled responseType: "+n)}}(l,n))},Jt._Implementations.loadAndExecuteScript=function(e,r,n){return function(e){var r=t.when.defer(),n=document.createElement("script");n.async=!0,n.src=e;var a=document.getElementsByTagName("head")[0];return n.onload=function(){n.onload=void 0,a.removeChild(n),r.resolve()},n.onerror=function(e){r.reject(e)},a.appendChild(n),r.promise}(e).otherwise(n.reject)},Jt._DefaultImplementations={},Jt._DefaultImplementations.createImage=Jt._Implementations.createImage,Jt._DefaultImplementations.loadWithXhr=Jt._Implementations.loadWithXhr,Jt._DefaultImplementations.loadAndExecuteScript=Jt._Implementations.loadAndExecuteScript,Jt.DEFAULT=t.freezeObject(new Jt({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),nr.NONE=t.freezeObject({getPromiseToLoad:function(){return t.when()},compute:function(e,r){return t.defined(r)?(r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0):r=new Se(0,0,0,0,0),r}}),nr.prototype.getPromiseToLoad=function(){return t.when(this._downloadPromise)},nr.prototype.compute=function(e,r){if(t.defined(this._samples)){if(t.defined(r)||(r=new Se(0,0,0,0,0)),0===this._samples.length)return r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0,r;var n=this._dates,a=this._lastIndex,i=0,o=0;if(t.defined(a)){var u=n[a],d=n[a+1],l=$e.lessThanOrEquals(u,e),c=!t.defined(d),f=c||$e.greaterThanOrEquals(d,e);if(l&&f)return i=a,!c&&d.equals(e)&&++i,o=i+1,ur(this,n,this._samples,e,i,o,r),r}var h=De(n,e,$e.compare,this._dateColumn);return h>=0?(h<n.length-1&&n[h+1].equals(e)&&++h,i=h,o=h):(i=(o=~h)-1)<0&&(i=0),this._lastIndex=i,ur(this,n,this._samples,e,i,o,r),r}if(t.defined(this._dataError))throw new s.RuntimeError(this._dataError)},dr.fromQuaternion=function(e,n){if(!t.defined(e))throw new r.DeveloperError("quaternion is required");t.defined(n)||(n=new dr);var a=2*(e.w*e.y-e.z*e.x),i=1-2*(e.x*e.x+e.y*e.y),o=2*(e.w*e.x+e.y*e.z),s=1-2*(e.y*e.y+e.z*e.z),u=2*(e.w*e.z+e.x*e.y);return n.heading=-Math.atan2(u,s),n.roll=Math.atan2(o,i),n.pitch=-Math.asin(a),n},dr.fromDegrees=function(e,a,i,o){if(!t.defined(e))throw new r.DeveloperError("heading is required");if(!t.defined(a))throw new r.DeveloperError("pitch is required");if(!t.defined(i))throw new r.DeveloperError("roll is required");return t.defined(o)||(o=new dr),o.heading=e*n.CesiumMath.RADIANS_PER_DEGREE,o.pitch=a*n.CesiumMath.RADIANS_PER_DEGREE,o.roll=i*n.CesiumMath.RADIANS_PER_DEGREE,o},dr.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.heading=e.heading,r.pitch=e.pitch,r.roll=e.roll,r):new dr(e.heading,e.pitch,e.roll)},dr.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.heading===r.heading&&e.pitch===r.pitch&&e.roll===r.roll},dr.equalsEpsilon=function(e,r,a,i){return e===r||t.defined(e)&&t.defined(r)&&n.CesiumMath.equalsEpsilon(e.heading,r.heading,a,i)&&n.CesiumMath.equalsEpsilon(e.pitch,r.pitch,a,i)&&n.CesiumMath.equalsEpsilon(e.roll,r.roll,a,i)},dr.prototype.clone=function(e){return dr.clone(this,e)},dr.prototype.equals=function(e){return dr.equals(this,e)},dr.prototype.equalsEpsilon=function(e,t,r){return dr.equalsEpsilon(this,e,t,r)},dr.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var lr,cr,fr,hr=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;function pr(e){return"undefined"==typeof document?e:(t.defined(lr)||(lr=document.createElement("a")),lr.href=e,lr.href=lr.href,lr.href)}function yr(){if(t.defined(cr))return cr;var e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"==typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?ht("..",wr("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),a=hr.exec(n);if(null!==a)return a[1]}}(),!t.defined(e))throw new r.DeveloperError("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return(cr=new Jt({url:pr(e)})).appendForwardSlash(),cr}function mr(e){return pr(require.toUrl("../"+e))}function Cr(e){return yr().getDerivedResource({url:e}).url}function wr(e){return t.defined(fr)||(fr="object"==typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?mr:Cr),fr(e)}function vr(e,t,r){this.x=e,this.y=t,this.s=r}function gr(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._xysFileUrlTemplate=Jt.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=t.defaultValue(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=t.defaultValue(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new $e(this._sampleZeroJulianEphemerisDate,0,Ie.TAI),this._stepSizeDays=t.defaultValue(e.stepSizeDays,1),this._samplesPerXysFile=t.defaultValue(e.samplesPerXysFile,1e3),this._totalSamples=t.defaultValue(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var r=this._interpolationOrder,n=this._denominators=new Array(r+1),a=this._xTable=new Array(r+1),i=Math.pow(this._stepSizeDays,r),o=0;o<=r;++o){n[o]=i,a[o]=o*this._stepSizeDays;for(var s=0;s<=r;++s)s!==o&&(n[o]*=o-s);n[o]=1/n[o]}this._work=new Array(r+1),this._coef=new Array(r+1)}wr._cesiumScriptRegex=hr,wr._buildModuleUrlFromBaseUrl=Cr,wr._clearBaseResource=function(){cr=void 0},wr.setBaseUrl=function(e){cr=Jt.DEFAULT.getDerivedResource({url:e})},wr.getCesiumBaseUrl=yr;var xr=new $e(0,0,Ie.TAI);function Or(e,t,r){var n=xr;return n.dayNumber=t,n.secondsOfDay=r,$e.daysDifference(n,e._sampleZeroDateTT)}function Er(e,r){if(e._chunkDownloadsInProgress[r])return e._chunkDownloadsInProgress[r];var n,a=t.when.defer();e._chunkDownloadsInProgress[r]=a;var i=e._xysFileUrlTemplate;return n=t.defined(i)?i.getDerivedResource({templateValues:{0:r}}):new Jt({url:wr("Assets/IAU2006_XYS/IAU2006_XYS_"+r+".json")}),t.when(n.fetchJson(),(function(t){e._chunkDownloadsInProgress[r]=!1;for(var n=e._samples,i=t.samples,o=r*e._samplesPerXysFile*3,s=0,u=i.length;s<u;++s)n[o+s]=i[s];a.resolve()})),a.promise}gr.prototype.preload=function(e,r,n,a){var i=Or(this,e,r),o=Or(this,n,a),s=i/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var d=s/this._samplesPerXysFile|0,l=u/this._samplesPerXysFile|0,c=[],f=d;f<=l;++f)c.push(Er(this,f));return t.when.all(c)},gr.prototype.computeXysRadians=function(e,r,n){var a=Or(this,e,r);if(!(a<0)){var i=a/this._stepSizeDays|0;if(!(i>=this._totalSamples)){var o=this._interpolationOrder,s=i-(o/2|0);s<0&&(s=0);var u=s+o;u>=this._totalSamples&&(s=(u=this._totalSamples-1)-o)<0&&(s=0);var d=!1,l=this._samples;if(t.defined(l[3*s])||(Er(this,s/this._samplesPerXysFile|0),d=!0),t.defined(l[3*u])||(Er(this,u/this._samplesPerXysFile|0),d=!0),!d){t.defined(n)?(n.x=0,n.y=0,n.s=0):n=new vr(0,0,0);var c,f,h=a-s*this._stepSizeDays,p=this._work,y=this._denominators,m=this._coef,C=this._xTable;for(c=0;c<=o;++c)p[c]=h-C[c];for(c=0;c<=o;++c){for(m[c]=1,f=0;f<=o;++f)f!==c&&(m[c]*=p[f]);m[c]*=y[c];var w=3*(s+c);n.x+=m[c]*l[w++],n.y+=m[c]*l[w++],n.s+=m[c]*l[w]}return n}}}};var _r={},br={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},qr={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Dr={},Sr={east:new a.Cartesian3,north:new a.Cartesian3,up:new a.Cartesian3,west:new a.Cartesian3,south:new a.Cartesian3,down:new a.Cartesian3},Rr=new a.Cartesian3,Tr=new a.Cartesian3,Mr=new a.Cartesian3;_r.localFrameToFixedFrameGenerator=function(e,s){if(!br.hasOwnProperty(e)||!br[e].hasOwnProperty(s))throw new r.DeveloperError("firstAxis and secondAxis must be east, north, up, west, south or down.");var u,d=br[e][s],l=e+s;return t.defined(Dr[l])?u=Dr[l]:(u=function(u,l,c){if(!t.defined(u))throw new r.DeveloperError("origin is required.");if(t.defined(c)||(c=new o.Matrix4),n.CesiumMath.equalsEpsilon(u.x,0,n.CesiumMath.EPSILON14)&&n.CesiumMath.equalsEpsilon(u.y,0,n.CesiumMath.EPSILON14)){var f=n.CesiumMath.sign(u.z);a.Cartesian3.unpack(qr[e],0,Rr),"east"!==e&&"west"!==e&&a.Cartesian3.multiplyByScalar(Rr,f,Rr),a.Cartesian3.unpack(qr[s],0,Tr),"east"!==s&&"west"!==s&&a.Cartesian3.multiplyByScalar(Tr,f,Tr),a.Cartesian3.unpack(qr[d],0,Mr),"east"!==d&&"west"!==d&&a.Cartesian3.multiplyByScalar(Mr,f,Mr)}else{(l=t.defaultValue(l,i.Ellipsoid.WGS84)).geodeticSurfaceNormal(u,Sr.up);var h=Sr.up,p=Sr.east;p.x=-u.y,p.y=u.x,p.z=0,a.Cartesian3.normalize(p,Sr.east),a.Cartesian3.cross(h,p,Sr.north),a.Cartesian3.multiplyByScalar(Sr.up,-1,Sr.down),a.Cartesian3.multiplyByScalar(Sr.east,-1,Sr.west),a.Cartesian3.multiplyByScalar(Sr.north,-1,Sr.south),Rr=Sr[e],Tr=Sr[s],Mr=Sr[d]}return c[0]=Rr.x,c[1]=Rr.y,c[2]=Rr.z,c[3]=0,c[4]=Tr.x,c[5]=Tr.y,c[6]=Tr.z,c[7]=0,c[8]=Mr.x,c[9]=Mr.y,c[10]=Mr.z,c[11]=0,c[12]=u.x,c[13]=u.y,c[14]=u.z,c[15]=1,c},Dr[l]=u),u},_r.eastNorthUpToFixedFrame=_r.localFrameToFixedFrameGenerator("east","north"),_r.northEastDownToFixedFrame=_r.localFrameToFixedFrameGenerator("north","east"),_r.northUpEastToFixedFrame=_r.localFrameToFixedFrameGenerator("north","up"),_r.northWestUpToFixedFrame=_r.localFrameToFixedFrameGenerator("north","west");var Pr=new Q,Ar=new a.Cartesian3(1,1,1),Ir=new o.Matrix4;_r.headingPitchRollToFixedFrame=function(e,n,i,s,u){r.Check.typeOf.object("HeadingPitchRoll",n),s=t.defaultValue(s,_r.eastNorthUpToFixedFrame);var d=Q.fromHeadingPitchRoll(n,Pr),l=o.Matrix4.fromTranslationQuaternionRotationScale(a.Cartesian3.ZERO,d,Ar,Ir);return u=s(e,i,u),o.Matrix4.multiply(u,l,u)};var Ur=new o.Matrix4,jr=new o.Matrix3;_r.headingPitchRollQuaternion=function(e,t,n,a,i){r.Check.typeOf.object("HeadingPitchRoll",t);var s=_r.headingPitchRollToFixedFrame(e,t,n,a,Ur),u=o.Matrix4.getRotation(s,jr);return Q.fromRotationMatrix(u,i)};var kr=new a.Cartesian3(1,1,1),zr=new a.Cartesian3,Nr=new o.Matrix4,Fr=new o.Matrix4,Vr=new o.Matrix3,Lr=new Q;_r.fixedFrameToHeadingPitchRoll=function(e,n,s,u){r.Check.defined("transform",e),n=t.defaultValue(n,i.Ellipsoid.WGS84),s=t.defaultValue(s,_r.eastNorthUpToFixedFrame),t.defined(u)||(u=new dr);var d=o.Matrix4.getTranslation(e,zr);if(a.Cartesian3.equals(d,a.Cartesian3.ZERO))return u.heading=0,u.pitch=0,u.roll=0,u;var l=o.Matrix4.inverseTransformation(s(d,n,Nr),Nr),c=o.Matrix4.setScale(e,kr,Fr);c=o.Matrix4.setTranslation(c,a.Cartesian3.ZERO,c),l=o.Matrix4.multiply(l,c,l);var f=Q.fromRotationMatrix(o.Matrix4.getRotation(l,Vr),Lr);return f=Q.normalize(f,f),dr.fromQuaternion(f,u)};var Br=n.CesiumMath.TWO_PI/86400,Wr=new $e;_r.computeTemeToPseudoFixedMatrix=function(e,a){if(!t.defined(e))throw new r.DeveloperError("date is required.");var i,s=(Wr=$e.addSeconds(e,-$e.computeTaiMinusUtc(e),Wr)).dayNumber,u=Wr.secondsOfDay,d=s-2451545,l=(24110.54841+(i=u>=43200?(d+.5)/Ae.DAYS_PER_JULIAN_CENTURY:(d-.5)/Ae.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+i*(.093104+-62e-7*i)))*Br%n.CesiumMath.TWO_PI+(72921158553e-15+11772758384668e-32*(s-2451545.5))*((u+.5*Ae.SECONDS_PER_DAY)%Ae.SECONDS_PER_DAY),c=Math.cos(l),f=Math.sin(l);return t.defined(a)?(a[0]=c,a[1]=-f,a[2]=0,a[3]=f,a[4]=c,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a):new o.Matrix3(c,f,0,-f,c,0,0,0,1)},_r.iau2006XysData=new gr,_r.earthOrientationParameters=nr.NONE;_r.preloadIcrfFixed=function(e){var r=e.start.dayNumber,n=e.start.secondsOfDay+32.184,a=e.stop.dayNumber,i=e.stop.secondsOfDay+32.184,o=_r.iau2006XysData.preload(r,n,a,i),s=_r.earthOrientationParameters.getPromiseToLoad();return t.when.all([o,s])},_r.computeIcrfToFixedMatrix=function(e,n){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(n)||(n=new o.Matrix3);var a=_r.computeFixedToIcrfMatrix(e,n);if(t.defined(a))return o.Matrix3.transpose(a,n)};var Hr=new vr(0,0,0),Xr=new Se(0,0,0,0,0,0),Yr=new o.Matrix3,Zr=new o.Matrix3;_r.computeFixedToIcrfMatrix=function(e,a){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(a)||(a=new o.Matrix3);var i=_r.earthOrientationParameters.compute(e,Xr);if(t.defined(i)){var s=e.dayNumber,u=e.secondsOfDay+32.184,d=_r.iau2006XysData.computeXysRadians(s,u,Hr);if(t.defined(d)){var l=d.x+i.xPoleOffset,c=d.y+i.yPoleOffset,f=1/(1+Math.sqrt(1-l*l-c*c)),h=Yr;h[0]=1-f*l*l,h[3]=-f*l*c,h[6]=l,h[1]=-f*l*c,h[4]=1-f*c*c,h[7]=c,h[2]=-l,h[5]=-c,h[8]=1-f*(l*l+c*c);var p=o.Matrix3.fromRotationZ(-d.s,Zr),y=o.Matrix3.multiply(h,p,Yr),m=e.dayNumber-2451545,C=(e.secondsOfDay-$e.computeTaiMinusUtc(e)+i.ut1MinusUtc)/Ae.SECONDS_PER_DAY,w=.779057273264+C+.00273781191135448*(m+C);w=w%1*n.CesiumMath.TWO_PI;var v=o.Matrix3.fromRotationZ(w,Zr),g=o.Matrix3.multiply(y,v,Yr),x=Math.cos(i.xPoleWander),O=Math.cos(i.yPoleWander),E=Math.sin(i.xPoleWander),_=Math.sin(i.yPoleWander),b=s-2451545+u/Ae.SECONDS_PER_DAY,q=-47e-6*(b/=36525)*n.CesiumMath.RADIANS_PER_DEGREE/3600,D=Math.cos(q),S=Math.sin(q),R=Zr;return R[0]=x*D,R[1]=x*S,R[2]=E,R[3]=-O*S+_*E*D,R[4]=O*D+_*E*S,R[5]=-_*x,R[6]=-_*S-O*E*D,R[7]=_*D-O*E*S,R[8]=O*x,o.Matrix3.multiply(g,R,a)}}};var Gr=new o.Cartesian4;_r.pointToWindowCoordinates=function(e,t,r,n){return(n=_r.pointToGLWindowCoordinates(e,t,r,n)).y=2*t[5]-n.y,n},_r.pointToGLWindowCoordinates=function(e,n,a,i){if(!t.defined(e))throw new r.DeveloperError("modelViewProjectionMatrix is required.");if(!t.defined(n))throw new r.DeveloperError("viewportTransformation is required.");if(!t.defined(a))throw new r.DeveloperError("point is required.");t.defined(i)||(i=new u.Cartesian2);var s=Gr;return o.Matrix4.multiplyByVector(e,o.Cartesian4.fromElements(a.x,a.y,a.z,1,s),s),o.Cartesian4.multiplyByScalar(s,1/s.w,s),o.Matrix4.multiplyByVector(n,s,s),u.Cartesian2.fromCartesian4(s,i)};var Jr=new a.Cartesian3,Qr=new a.Cartesian3,Kr=new a.Cartesian3;_r.rotationMatrixFromPositionVelocity=function(e,s,u,d){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(s))throw new r.DeveloperError("velocity is required.");var l=t.defaultValue(u,i.Ellipsoid.WGS84).geodeticSurfaceNormal(e,Jr),c=a.Cartesian3.cross(s,l,Qr);a.Cartesian3.equalsEpsilon(c,a.Cartesian3.ZERO,n.CesiumMath.EPSILON6)&&(c=a.Cartesian3.clone(a.Cartesian3.UNIT_X,c));var f=a.Cartesian3.cross(c,s,Kr);return a.Cartesian3.normalize(f,f),a.Cartesian3.cross(s,f,c),a.Cartesian3.negate(c,c),a.Cartesian3.normalize(c,c),t.defined(d)||(d=new o.Matrix3),d[0]=s.x,d[1]=s.y,d[2]=s.z,d[3]=c.x,d[4]=c.y,d[5]=c.z,d[6]=f.x,d[7]=f.y,d[8]=f.z,d};var $r=new o.Matrix4(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),en=new i.Cartographic,tn=new a.Cartesian3,rn=new a.Cartesian3,nn=new o.Matrix3,an=new o.Matrix4,on=new o.Matrix4;_r.basisTo2D=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(n))throw new r.DeveloperError("matrix is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var s=o.Matrix4.getTranslation(n,rn),u=e.ellipsoid,d=u.cartesianToCartographic(s,en),l=e.project(d,tn);a.Cartesian3.fromElements(l.z,l.x,l.y,l);var c=_r.eastNorthUpToFixedFrame(s,u,an),f=o.Matrix4.inverseTransformation(c,on),h=o.Matrix4.getRotation(n,nn),p=o.Matrix4.multiplyByMatrix3(f,h,i);return o.Matrix4.multiply($r,p,i),o.Matrix4.setTranslation(i,l,i),i},_r.wgs84To2DModelMatrix=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(n))throw new r.DeveloperError("center is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var s=e.ellipsoid,u=_r.eastNorthUpToFixedFrame(n,s,an),d=o.Matrix4.inverseTransformation(u,on),l=s.cartesianToCartographic(n,en),c=e.project(l,tn);a.Cartesian3.fromElements(c.z,c.x,c.y,c);var f=o.Matrix4.fromTranslation(c,an);return o.Matrix4.multiply($r,d,i),o.Matrix4.multiply(f,i,i),i},e.BoundingSphere=h,e.GeographicProjection=l,e.Intersect=c,e.Interval=f,e.Quaternion=Q,e.Resource=Jt,e.Transforms=_r,e.buildModuleUrl=wr,e.deprecationWarning=ft,e.isArray=gt,e.oneTimeWarning=ct}));
